
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Ejercicio 1 parte 2 &#8212; Primer parcial ML</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Ejercicio_1parte_2';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Análisis del Problema de Aplicación" href="Datos_Belka%28EDA_Modelo%29.html" />
    <link rel="prev" title="Breast Cancer" href="Ejercicio_1parte_1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Primer parcial ML - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Primer parcial ML - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Primer parcial
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ejercicio_1parte_1.html">Breast Cancer</a></li>


<li class="toctree-l1 current active"><a class="current reference internal" href="#">Ejercicio 1 parte 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Datos_Belka%28EDA_Modelo%29.html">Análisis del Problema de Aplicación</a></li>




<li class="toctree-l1"><a class="reference internal" href="Ejercicio_2parte_2%28EDA%29.html">Ejercicio 2</a></li>

<li class="toctree-l1"><a class="reference internal" href="Ejercicio_4.html">Ejericico 4</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FEjercicio_1parte_2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Ejercicio_1parte_2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Ejercicio 1 parte 2</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-paquetes-necesarios">Librerías y paquetes necesarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos-eda">Análisis Exploratorio de los datos - EDA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importamos-el-conjunto-de-datos">Importamos el conjunto de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nombres-de-las-variables">Nombres de las variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-descriptivas">Gráficas descriptivas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad">Multicolinealidad</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-lineal-multiple">Modelo de regresión Lineal Múltiple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-realizado-con-funciones-de-libreria">Modelo realizado con funciones de librería</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-del-modelo">Métricas del modelo</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-root-mean-squared-error">RMSE (Root Mean Squared Error)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mae-mean-absolute-error">MAE (Mean Absolute Error)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-mean-squared-error">MSE (Mean Squared Error)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mape-mean-absolute-percentage-error">MAPE (Mean Absolute Percentage Error)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-realizado-manualmente">Modelo realizado manualmente</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-k-nn">Modelo de regresión K-NN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-knn-realizado-manualmente">Modelo KNN realizado manualmente</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-conjunto-de-entrenamiento-y-prueba">Gráficas conjunto de entrenamiento y prueba</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ejercicio-1-parte-2">
<h1>Ejercicio 1 parte 2<a class="headerlink" href="#ejercicio-1-parte-2" title="Link to this heading">#</a></h1>
<p>Considere los ejemplos vistos en clase, en los que se analizó la
implementación de los modelos: <code class="docutils literal notranslate"><span class="pre">k-nn</span></code>, <code class="docutils literal notranslate"><span class="pre">regresión</span> <span class="pre">lineal</span></code>, <code class="docutils literal notranslate"><span class="pre">regresión</span> <span class="pre">logística</span></code>. Realice hiperparametrización
y validación cruzada usando (i) <code class="docutils literal notranslate"><span class="pre">GridSearchCV</span></code> y <code class="docutils literal notranslate"><span class="pre">Pipeline</span></code> vs (ii) Manualmente, sin usar GridSearchCV
y Pipeline (Use ciclos FOR, WHILE, etc,… ). Verifique que los scores obtenidos en los ítems (i)-(ii)
son los mismos. Los ejercicios son los siguientes:</p>
<ul class="simple">
<li><p>Boston Housing: (<code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code>, <code class="docutils literal notranslate"><span class="pre">KNN</span></code>). Utilice la métrica <code class="docutils literal notranslate"><span class="pre">R2</span></code> y <code class="docutils literal notranslate"><span class="pre">RMSE</span></code> durante la evaluación y
selección del modelo. Los resultados deben ser presentados usando el Cuadro 2. Realice un gráfico
en el que muestre en los conjuntos de entrenamiento y test, el precio original y el predicho. El
estudiante que obtenga el mejor score con esta métrica, será premiado con una décima para el
corte.</p></li>
</ul>
<p>Los datos deben ser cargados mediante el siguiente par de líneas:</p>
<ul class="simple">
<li><p>import mglearn</p></li>
<li><p>X, y = mglearn.datasets.load_extended_boston())</p></li>
</ul>
<section id="librerias-y-paquetes-necesarios">
<h2>Librerías y paquetes necesarios<a class="headerlink" href="#librerias-y-paquetes-necesarios" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="kn">import</span> <span class="nn">mglearn</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">make_scorer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="analisis-exploratorio-de-los-datos-eda">
<h2>Análisis Exploratorio de los datos - EDA<a class="headerlink" href="#analisis-exploratorio-de-los-datos-eda" title="Link to this heading">#</a></h2>
<section id="importamos-el-conjunto-de-datos">
<h3>Importamos el conjunto de datos<a class="headerlink" href="#importamos-el-conjunto-de-datos" title="Link to this heading">#</a></h3>
<p>Inicialmente extraemos los datos de la librería <code class="docutils literal notranslate"><span class="pre">mglearn</span></code>, en la cual asignamos a una matriz X nuestras 506 observaciones de 104 variables diferentes y a un vector <code class="docutils literal notranslate"><span class="pre">Target</span></code> nuestros 506 valores que se obtuvieron con base a los <code class="docutils literal notranslate"><span class="pre">Predictors</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">mglearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_extended_boston</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Explorar los datos</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of X:&quot;</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Muestra el número de muestras y características</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape of y:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># Muestra el número de etiquetas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shape of X: (506, 104)
Shape of y: (506,)
</pre></div>
</div>
</div>
</div>
</section>
<section id="nombres-de-las-variables">
<h3>Nombres de las variables<a class="headerlink" href="#nombres-de-las-variables" title="Link to this heading">#</a></h3>
<p>Cada uno de las variables involucradas en nuestro análisis corresponen al conjunto de datos de precios promedio de las viviendas en Boston, el cual se desea estimar con base a las mismas y combinaciones entre si.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">original_feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ZN&#39;</span><span class="p">,</span> <span class="s1">&#39;INDUS&#39;</span><span class="p">,</span> <span class="s1">&#39;CHAS&#39;</span><span class="p">,</span> <span class="s1">&#39;NOX&#39;</span><span class="p">,</span> <span class="s1">&#39;RM&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIS&#39;</span><span class="p">,</span> <span class="s1">&#39;RAD&#39;</span><span class="p">,</span> <span class="s1">&#39;TAX&#39;</span><span class="p">,</span> <span class="s1">&#39;PTRATIO&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;LSTAT&#39;</span><span class="p">]</span>

<span class="n">extended_feature_names</span> <span class="o">=</span> <span class="n">original_feature_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Añadir términos cuadráticos y combinaciones (interacciones) de las características originales</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">original_feature_names</span><span class="p">)):</span>
    <span class="n">extended_feature_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">original_feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">^2&#39;</span><span class="p">)</span>  <span class="c1"># Términos cuadráticos</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">original_feature_names</span><span class="p">)):</span>
        <span class="n">extended_feature_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">original_feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">*</span><span class="si">{</span><span class="n">original_feature_names</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Interacciones</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">extended_feature_names</span><span class="p">)</span>
<span class="n">df_y</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_X</span><span class="p">,</span> <span class="n">df_y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----+-------------+-------+-----------+--------+----------+----------+----------+----------+-----------+-----------+-----------+----------+-----------+-------------+-------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+----------------+-------------+--------------+----------+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+--------------+----------+------------+------------+--------------+-------------+------------+-------------+-------------+-------------+-------------+-----------------+-----------+---------------+----------+------------+-----------+------------+------------+------------+------------+----------------+----------+--------------+-----------+-----------+-----------+-----------+------------+-----------+---------------+----------+-------------+----------+----------+----------+-----------+-----------+--------------+----------+------------+----------+-----------+-----------+-----------+---------------+----------+-------------+-----------+-----------+-----------+---------------+----------+-------------+------------+------------+---------------+-----------+-------------+------------+---------------+-----------+-------------+-------------+-------------+-----------------+----------+-----------+------------+--------+
|    |        CRIM |    ZN |     INDUS |   CHAS |      NOX |       RM |      AGE |      DIS |       RAD |       TAX |   PTRATIO |        B |     LSTAT |      CRIM^2 |     CRIM*ZN |   CRIM*INDUS |   CRIM*CHAS |    CRIM*NOX |     CRIM*RM |    CRIM*AGE |    CRIM*DIS |    CRIM*RAD |    CRIM*TAX |   CRIM*PTRATIO |      CRIM*B |   CRIM*LSTAT |     ZN^2 |   ZN*INDUS |   ZN*CHAS |    ZN*NOX |     ZN*RM |    ZN*AGE |    ZN*DIS |    ZN*RAD |    ZN*TAX |   ZN*PTRATIO |     ZN*B |   ZN*LSTAT |    INDUS^2 |   INDUS*CHAS |   INDUS*NOX |   INDUS*RM |   INDUS*AGE |   INDUS*DIS |   INDUS*RAD |   INDUS*TAX |   INDUS*PTRATIO |   INDUS*B |   INDUS*LSTAT |   CHAS^2 |   CHAS*NOX |   CHAS*RM |   CHAS*AGE |   CHAS*DIS |   CHAS*RAD |   CHAS*TAX |   CHAS*PTRATIO |   CHAS*B |   CHAS*LSTAT |     NOX^2 |    NOX*RM |   NOX*AGE |   NOX*DIS |    NOX*RAD |   NOX*TAX |   NOX*PTRATIO |    NOX*B |   NOX*LSTAT |     RM^2 |   RM*AGE |   RM*DIS |    RM*RAD |    RM*TAX |   RM*PTRATIO |     RM*B |   RM*LSTAT |    AGE^2 |   AGE*DIS |   AGE*RAD |   AGE*TAX |   AGE*PTRATIO |    AGE*B |   AGE*LSTAT |     DIS^2 |   DIS*RAD |   DIS*TAX |   DIS*PTRATIO |    DIS*B |   DIS*LSTAT |      RAD^2 |    RAD*TAX |   RAD*PTRATIO |     RAD*B |   RAD*LSTAT |      TAX^2 |   TAX*PTRATIO |     TAX*B |   TAX*LSTAT |   PTRATIO^2 |   PTRATIO*B |   PTRATIO*LSTAT |      B^2 |   B*LSTAT |    LSTAT^2 |   MEDV |
|----+-------------+-------+-----------+--------+----------+----------+----------+----------+-----------+-----------+-----------+----------+-----------+-------------+-------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+----------------+-------------+--------------+----------+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+--------------+----------+------------+------------+--------------+-------------+------------+-------------+-------------+-------------+-------------+-----------------+-----------+---------------+----------+------------+-----------+------------+------------+------------+------------+----------------+----------+--------------+-----------+-----------+-----------+-----------+------------+-----------+---------------+----------+-------------+----------+----------+----------+-----------+-----------+--------------+----------+------------+----------+-----------+-----------+-----------+---------------+----------+-------------+-----------+-----------+-----------+---------------+----------+-------------+------------+------------+---------------+-----------+-------------+------------+---------------+-----------+-------------+-------------+-------------+-----------------+----------+-----------+------------+--------|
|  0 | 0           | 0.18  | 0.0678152 |      0 | 0.314815 | 0.577505 | 0.641607 | 0.269203 | 0         | 0.208015  |  0.287234 | 1        | 0.0896799 | 0           | 0           |  0           |           0 | 0           | 0           | 0           | 0           | 0           | 0           |    0           | 0           |  0           | 0.0324   |  0.0122067 |         0 | 0.0566667 | 0.103951  | 0.115489  | 0.0484566 | 0         | 0.0374427 |    0.0517021 | 0.18     |  0.0161424 | 0.00459891 |            0 |  0.0213492  |  0.0391637 |   0.0435107 |   0.0182561 |   0         |  0.0141066  |       0.0194788 | 0.0678152 |    0.00608167 |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0991084 | 0.181807  | 0.201987  | 0.0847491 | 0          | 0.0654863 |     0.0904255 | 0.314815 |  0.0282326  | 0.333512 | 0.370531 | 0.155466 | 0         | 0.12013   |     0.165879 | 0.577505 |  0.0517906 | 0.411659 |  0.172723 | 0         | 0.133464  |      0.184291 | 0.641607 |   0.0575392 | 0.0724703 | 0         | 0.0559984 |     0.0773243 | 0.269203 |   0.0241421 | 0          | 0          |     0         | 0         |  0          | 0.0432704  |     0.0597491 | 0.208015  |  0.0186548  |   0.0825034 |    0.287234 |       0.0257591 | 1        | 0.0896799 | 0.00804249 |   24   |
|  1 | 0.000235923 | 0     | 0.242302  |      0 | 0.17284  | 0.547998 | 0.782698 | 0.348962 | 0.0434783 | 0.104962  |  0.553191 | 1        | 0.20447   | 5.56594e-08 | 0           |  5.71645e-05 |           0 | 4.07767e-05 | 0.000129285 | 0.000184656 | 8.2328e-05  | 1.02575e-05 | 2.47629e-05 |    0.00013051  | 0.000235923 |  4.82391e-05 | 0        |  0         |         0 | 0         | 0         | 0         | 0         | 0         | 0         |    0         | 0        |  0         | 0.0587103  |            0 |  0.0418794  |  0.132781  |   0.189649  |   0.0845542 |   0.0105349 |  0.0254325  |       0.134039  | 0.242302  |    0.0495435  |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0298735 | 0.0947157 | 0.135281  | 0.0603144 | 0.00751476 | 0.0181416 |     0.0956133 | 0.17284  |  0.0353405  | 0.300301 | 0.428917 | 0.19123  | 0.023826  | 0.0575188 |     0.303148 | 0.547998 |  0.112049  | 0.612617 |  0.273132 | 0.0340304 | 0.0821534 |      0.432982 | 0.782698 |   0.160038  | 0.121774  | 0.0151723 | 0.0366277 |     0.193043  | 0.348962 |   0.0713523 | 0.00189036 | 0.00456356 |     0.0240518 | 0.0434783 |  0.00889001 | 0.011017   |     0.058064  | 0.104962  |  0.0214616  |   0.306021  |    0.553191 |       0.113111  | 1        | 0.20447   | 0.0418081  |   21.6 |
|  2 | 0.000235698 | 0     | 0.242302  |      0 | 0.17284  | 0.694386 | 0.599382 | 0.348962 | 0.0434783 | 0.104962  |  0.553191 | 0.989737 | 0.0634658 | 5.55534e-08 | 0           |  5.711e-05   |           0 | 4.07379e-05 | 0.000163665 | 0.000141273 | 8.22496e-05 | 1.02477e-05 | 2.47393e-05 |    0.000130386 | 0.000233279 |  1.49587e-05 | 0        |  0         |         0 | 0         | 0         | 0         | 0         | 0         | 0         |    0         | 0        |  0         | 0.0587103  |            0 |  0.0418794  |  0.168251  |   0.145232  |   0.0845542 |   0.0105349 |  0.0254325  |       0.134039  | 0.239815  |    0.0153779  |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0298735 | 0.120017  | 0.103597  | 0.0603144 | 0.00751476 | 0.0181416 |     0.0956133 | 0.171066 |  0.0109694  | 0.482172 | 0.416202 | 0.242314 | 0.0301907 | 0.072884  |     0.384128 | 0.68726  |  0.0440697 | 0.359259 |  0.209162 | 0.0260601 | 0.0629122 |      0.331573 | 0.593231 |   0.0380403 | 0.121774  | 0.0151723 | 0.0366277 |     0.193043  | 0.345381 |   0.0221471 | 0.00189036 | 0.00456356 |     0.0240518 | 0.0430321 |  0.00275938 | 0.011017   |     0.058064  | 0.103885  |  0.00666148 |   0.306021  |    0.547514 |       0.0351087 | 0.97958  | 0.0628145 | 0.00402791 |   34.7 |
|  3 | 0.000292796 | 0     | 0.0630499 |      0 | 0.150206 | 0.658555 | 0.441813 | 0.448545 | 0.0869565 | 0.0667939 |  0.648936 | 0.994276 | 0.0333885 | 8.57293e-08 | 0           |  1.84607e-05 |           0 | 4.39796e-05 | 0.000192822 | 0.000129361 | 0.000131332 | 2.54605e-05 | 1.9557e-05  |    0.000190006 | 0.00029112  |  9.77602e-06 | 0        |  0         |         0 | 0         | 0         | 0         | 0         | 0         | 0         |    0         | 0        |  0         | 0.00397528 |            0 |  0.00947045 |  0.0415218 |   0.0278562 |   0.0282807 |   0.0054826 |  0.00421135 |       0.0409153 | 0.062689  |    0.00210514 |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0225618 | 0.0989188 | 0.0663628 | 0.067374  | 0.0130614  | 0.0100328 |     0.097474  | 0.149346 |  0.00501515 | 0.433695 | 0.290958 | 0.295391 | 0.0572657 | 0.0439875 |     0.42736  | 0.654786 |  0.0219882 | 0.195198 |  0.198173 | 0.0384185 | 0.0295104 |      0.286708 | 0.439284 |   0.0147515 | 0.201192  | 0.0390039 | 0.02996   |     0.291077  | 0.445977 |   0.0149762 | 0.00756144 | 0.00580816 |     0.0564292 | 0.0864588 |  0.00290335 | 0.00446142 |     0.043345  | 0.0664116 |  0.00223015 |   0.421118  |    0.645222 |       0.021667  | 0.988585 | 0.0331974 | 0.00111479 |   33.4 |
|  4 | 0.00070507  | 0     | 0.0630499 |      0 | 0.150206 | 0.687105 | 0.528321 | 0.448545 | 0.0869565 | 0.0667939 |  0.648936 | 1        | 0.0993377 | 4.97124e-07 | 0           |  4.44546e-05 |           0 | 0.000105906 | 0.000484457 | 0.000372504 | 0.000316255 | 6.13104e-05 | 4.70944e-05 |    0.000457545 | 0.00070507  |  7.00401e-05 | 0        |  0         |         0 | 0         | 0         | 0         | 0         | 0         | 0         |    0         | 0        |  0         | 0.00397528 |            0 |  0.00947045 |  0.0433219 |   0.0333106 |   0.0282807 |   0.0054826 |  0.00421135 |       0.0409153 | 0.0630499 |    0.00626323 |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0225618 | 0.103207  | 0.0793569 | 0.067374  | 0.0130614  | 0.0100328 |     0.097474  | 0.150206 |  0.0149211  | 0.472113 | 0.363012 | 0.308197 | 0.0597482 | 0.0458944 |     0.445887 | 0.687105 |  0.0682554 | 0.279123 |  0.236976 | 0.045941  | 0.0352886 |      0.342847 | 0.528321 |   0.0524823 | 0.201192  | 0.0390039 | 0.02996   |     0.291077  | 0.448545 |   0.0445574 | 0.00756144 | 0.00580816 |     0.0564292 | 0.0869565 |  0.00863807 | 0.00446142 |     0.043345  | 0.0667939 |  0.00663515 |   0.421118  |    0.648936 |       0.0644639 | 1        | 0.0993377 | 0.00986799 |   36.2 |
|  5 | 0.000264472 | 0     | 0.0630499 |      0 | 0.150206 | 0.549722 | 0.574665 | 0.448545 | 0.0869565 | 0.0667939 |  0.648936 | 0.99299  | 0.0960265 | 6.99452e-08 | 0           |  1.66749e-05 |           0 | 3.97251e-05 | 0.000145386 | 0.000151983 | 0.000118627 | 2.29975e-05 | 1.76651e-05 |    0.000171625 | 0.000262618 |  2.53963e-05 | 0        |  0         |         0 | 0         | 0         | 0         | 0         | 0         | 0         |    0         | 0        |  0         | 0.00397528 |            0 |  0.00947045 |  0.0346599 |   0.0362326 |   0.0282807 |   0.0054826 |  0.00421135 |       0.0409153 | 0.0626079 |    0.00605446 |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0225618 | 0.0825714 | 0.086318  | 0.067374  | 0.0130614  | 0.0100328 |     0.097474  | 0.149153 |  0.0144237  | 0.302194 | 0.315906 | 0.246575 | 0.0478019 | 0.0367181 |     0.356735 | 0.545869 |  0.0527879 | 0.33024  |  0.257763 | 0.0499709 | 0.0383841 |      0.372921 | 0.570637 |   0.0551831 | 0.201192  | 0.0390039 | 0.02996   |     0.291077  | 0.4454   |   0.0430722 | 0.00756144 | 0.00580816 |     0.0564292 | 0.086347  |  0.00835013 | 0.00446142 |     0.043345  | 0.0663257 |  0.00641398 |   0.421118  |    0.644387 |       0.0623151 | 0.986029 | 0.0953534 | 0.00922109 |   28.7 |
|  6 | 0.000921323 | 0.125 | 0.271628  |      0 | 0.286008 | 0.46963  | 0.656025 | 0.402923 | 0.173913  | 0.236641  |  0.276596 | 0.996722 | 0.295254  | 8.48836e-07 | 0.000115165 |  0.000250257 |           0 | 0.000263506 | 0.000432681 | 0.000604411 | 0.000371222 | 0.00016023  | 0.000218023 |    0.000254834 | 0.000918303 |  0.000272024 | 0.015625 |  0.0339534 |         0 | 0.035751  | 0.0587038 | 0.0820031 | 0.0503653 | 0.0217391 | 0.0295802 |    0.0345745 | 0.12459  |  0.0369067 | 0.0737815  |            0 |  0.0776877  |  0.127565  |   0.178194  |   0.109445  |   0.0472396 |  0.0642783  |       0.075131  | 0.270737  |    0.0801991  |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0818007 | 0.134318  | 0.187628  | 0.115239  | 0.0497406  | 0.0676813 |     0.0791087 | 0.285071 |  0.084445   | 0.220553 | 0.308089 | 0.189225 | 0.0816748 | 0.111134  |     0.129898 | 0.468091 |  0.13866   | 0.430368 |  0.264327 | 0.114091  | 0.155242  |      0.181454 | 0.653874 |   0.193694  | 0.162347  | 0.0700735 | 0.0953481 |     0.111447  | 0.401602 |   0.118964  | 0.0302457  | 0.041155   |     0.0481036 | 0.173343  |  0.0513485  | 0.0559991  |     0.065454  | 0.235866  |  0.0698692  |   0.0765052 |    0.275689 |       0.081666  | 0.993455 | 0.294286  | 0.0871748  |   22.9 |
|  7 | 0.00155367  | 0.125 | 0.271628  |      0 | 0.286008 | 0.500287 | 0.959835 | 0.438387 | 0.173913  | 0.236641  |  0.276596 | 1        | 0.480684  | 2.4139e-06  | 0.000194209 |  0.00042202  |           0 | 0.000444363 | 0.000777282 | 0.00149127  | 0.00068111  | 0.000270204 | 0.000367663 |    0.000429739 | 0.00155367  |  0.000746826 | 0.015625 |  0.0339534 |         0 | 0.035751  | 0.0625359 | 0.119979  | 0.0547984 | 0.0217391 | 0.0295802 |    0.0345745 | 0.125    |  0.0600855 | 0.0737815  |            0 |  0.0776877  |  0.135892  |   0.260718  |   0.119078  |   0.0472396 |  0.0642783  |       0.075131  | 0.271628  |    0.130567   |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0818007 | 0.143086  | 0.274521  | 0.125382  | 0.0497406  | 0.0676813 |     0.0791087 | 0.286008 |  0.13748    | 0.250287 | 0.480193 | 0.21932  | 0.0870065 | 0.118389  |     0.138377 | 0.500287 |  0.24048   | 0.921284 |  0.420779 | 0.166928  | 0.227137  |      0.265486 | 0.959835 |   0.461378  | 0.192183  | 0.0762412 | 0.10374   |     0.121256  | 0.438387 |   0.210726  | 0.0302457  | 0.041155   |     0.0481036 | 0.173913  |  0.0835973  | 0.0559991  |     0.065454  | 0.236641  |  0.11375    |   0.0765052 |    0.276596 |       0.132955  | 1        | 0.480684  | 0.231057   |   27.1 |
|  8 | 0.00230325  | 0.125 | 0.271628  |      0 | 0.286008 | 0.396628 | 1        | 0.450354 | 0.173913  | 0.236641  |  0.276596 | 0.974104 | 0.778146  | 5.30497e-06 | 0.000287906 |  0.000625627 |           0 | 0.000658749 | 0.000913533 | 0.00230325  | 0.00103728  | 0.000400565 | 0.000545044 |    0.00063707  | 0.00224361  |  0.00179227  | 0.015625 |  0.0339534 |         0 | 0.035751  | 0.0495785 | 0.125     | 0.0562943 | 0.0217391 | 0.0295802 |    0.0345745 | 0.121763 |  0.0972682 | 0.0737815  |            0 |  0.0776877  |  0.107735  |   0.271628  |   0.122329  |   0.0472396 |  0.0642783  |       0.075131  | 0.264593  |    0.211366   |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0818007 | 0.113439  | 0.286008  | 0.128805  | 0.0497406  | 0.0676813 |     0.0791087 | 0.278602 |  0.222556   | 0.157314 | 0.396628 | 0.178623 | 0.0689787 | 0.0938585 |     0.109706 | 0.386356 |  0.308634  | 1        |  0.450354 | 0.173913  | 0.236641  |      0.276596 | 0.974104 |   0.778146  | 0.202819  | 0.0783225 | 0.106572  |     0.124566  | 0.438692 |   0.350441  | 0.0302457  | 0.041155   |     0.0481036 | 0.169409  |  0.13533    | 0.0559991  |     0.065454  | 0.230513  |  0.184141   |   0.0765052 |    0.269433 |       0.215232  | 0.948878 | 0.757995  | 0.605511   |   16.5 |
|  9 | 0.00184017  | 0.125 | 0.271628  |      0 | 0.286008 | 0.468097 | 0.854789 | 0.496731 | 0.173913  | 0.236641  |  0.276596 | 0.974305 | 0.424117  | 3.38624e-06 | 0.000230022 |  0.000499842 |           0 | 0.000526305 | 0.00086138  | 0.00157296  | 0.000914071 | 0.00032003  | 0.000435461 |    0.000508984 | 0.00179289  |  0.000780449 | 0.015625 |  0.0339534 |         0 | 0.035751  | 0.0585122 | 0.106849  | 0.0620914 | 0.0217391 | 0.0295802 |    0.0345745 | 0.121788 |  0.0530146 | 0.0737815  |            0 |  0.0776877  |  0.127148  |   0.232184  |   0.134926  |   0.0472396 |  0.0642783  |       0.075131  | 0.264648  |    0.115202   |        0 |          0 |         0 |          0 |          0 |          0 |          0 |              0 |        0 |            0 | 0.0818007 | 0.13388   | 0.244477  | 0.142069  | 0.0497406  | 0.0676813 |     0.0791087 | 0.278659 |  0.121301   | 0.219115 | 0.400124 | 0.232518 | 0.0814082 | 0.110771  |     0.129474 | 0.45607  |  0.198528  | 0.730664 |  0.4246   | 0.148659  | 0.202278  |      0.236431 | 0.832825 |   0.36253   | 0.246742  | 0.086388  | 0.117547  |     0.137394  | 0.483968 |   0.210672  | 0.0302457  | 0.041155   |     0.0481036 | 0.169444  |  0.0737595  | 0.0559991  |     0.065454  | 0.230561  |  0.100364   |   0.0765052 |    0.269489 |       0.117309  | 0.949271 | 0.413219  | 0.179875   |   18.9 |
+----+-------------+-------+-----------+--------+----------+----------+----------+----------+-----------+-----------+-----------+----------+-----------+-------------+-------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+----------------+-------------+--------------+----------+------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+--------------+----------+------------+------------+--------------+-------------+------------+-------------+-------------+-------------+-------------+-----------------+-----------+---------------+----------+------------+-----------+------------+------------+------------+------------+----------------+----------+--------------+-----------+-----------+-----------+-----------+------------+-----------+---------------+----------+-------------+----------+----------+----------+-----------+-----------+--------------+----------+------------+----------+-----------+-----------+-----------+---------------+----------+-------------+-----------+-----------+-----------+---------------+----------+-------------+------------+------------+---------------+-----------+-------------+------------+---------------+-----------+-------------+-------------+-------------+-----------------+----------+-----------+------------+--------+
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(506, 105)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">summary</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="n">headers</span> <span class="o">=</span> <span class="s1">&#39;keys&#39;</span><span class="p">,</span> <span class="n">tablefmt</span> <span class="o">=</span> <span class="s1">&#39;psql&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------+---------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+---------------+---------------+---------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+---------------+---------------+-------------+-------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+--------------+------------+-------------+-------------+--------------+-------------+------------+-------------+-------------+-------------+-------------+-----------------+------------+---------------+------------+-------------+-------------+-------------+-------------+-------------+-------------+----------------+------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+---------------+------------+-------------+------------+------------+-------------+-------------+-------------+--------------+------------+-------------+------------+-------------+-------------+-------------+---------------+------------+-------------+--------------+-------------+-------------+---------------+-------------+-------------+-------------+-------------+---------------+------------+-------------+-------------+---------------+------------+-------------+-------------+-------------+-----------------+------------+------------+-------------+----------+
|       |          CRIM |         ZN |      INDUS |       CHAS |        NOX |         RM |        AGE |        DIS |        RAD |        TAX |    PTRATIO |          B |      LSTAT |        CRIM^2 |       CRIM*ZN |    CRIM*INDUS |    CRIM*CHAS |      CRIM*NOX |       CRIM*RM |      CRIM*AGE |      CRIM*DIS |      CRIM*RAD |      CRIM*TAX |   CRIM*PTRATIO |        CRIM*B |    CRIM*LSTAT |        ZN^2 |    ZN*INDUS |      ZN*CHAS |      ZN*NOX |       ZN*RM |      ZN*AGE |      ZN*DIS |      ZN*RAD |      ZN*TAX |   ZN*PTRATIO |       ZN*B |    ZN*LSTAT |     INDUS^2 |   INDUS*CHAS |   INDUS*NOX |   INDUS*RM |   INDUS*AGE |   INDUS*DIS |   INDUS*RAD |   INDUS*TAX |   INDUS*PTRATIO |    INDUS*B |   INDUS*LSTAT |     CHAS^2 |    CHAS*NOX |     CHAS*RM |    CHAS*AGE |    CHAS*DIS |    CHAS*RAD |    CHAS*TAX |   CHAS*PTRATIO |     CHAS*B |   CHAS*LSTAT |       NOX^2 |      NOX*RM |     NOX*AGE |     NOX*DIS |     NOX*RAD |     NOX*TAX |   NOX*PTRATIO |      NOX*B |   NOX*LSTAT |       RM^2 |     RM*AGE |      RM*DIS |      RM*RAD |      RM*TAX |   RM*PTRATIO |       RM*B |    RM*LSTAT |      AGE^2 |     AGE*DIS |     AGE*RAD |     AGE*TAX |   AGE*PTRATIO |      AGE*B |   AGE*LSTAT |        DIS^2 |     DIS*RAD |     DIS*TAX |   DIS*PTRATIO |       DIS*B |   DIS*LSTAT |       RAD^2 |     RAD*TAX |   RAD*PTRATIO |      RAD*B |   RAD*LSTAT |       TAX^2 |   TAX*PTRATIO |      TAX*B |   TAX*LSTAT |   PTRATIO^2 |   PTRATIO*B |   PTRATIO*LSTAT |        B^2 |    B*LSTAT |     LSTAT^2 |     MEDV |
|-------+---------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+---------------+---------------+---------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+---------------+---------------+-------------+-------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+--------------+------------+-------------+-------------+--------------+-------------+------------+-------------+-------------+-------------+-------------+-----------------+------------+---------------+------------+-------------+-------------+-------------+-------------+-------------+-------------+----------------+------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+---------------+------------+-------------+------------+------------+-------------+-------------+-------------+--------------+------------+-------------+------------+-------------+-------------+-------------+---------------+------------+-------------+--------------+-------------+-------------+---------------+-------------+-------------+-------------+-------------+---------------+------------+-------------+-------------+---------------+------------+-------------+-------------+-------------+-----------------+------------+------------+-------------+----------|
| count | 506           | 506        | 506        | 506        | 506        | 506        | 506        | 506        | 506        | 506        | 506        | 506        | 506        | 506           | 506           | 506           | 506          | 506           | 506           | 506           | 506           | 506           | 506           |   506          | 506           | 506           | 506         | 506         | 506          | 506         | 506         | 506         | 506         | 506         | 506         | 506          | 506        | 506         | 506         |  506         | 506         | 506        | 506         | 506         | 506         | 506         |     506         | 506        |   506         | 506        | 506         | 506         | 506         | 506         | 506         | 506         |    506         | 506        |  506         | 506         | 506         | 506         | 506         | 506         | 506         |    506        | 506        | 506         | 506        | 506        | 506         | 506         | 506         |   506        | 506        | 506         | 506        | 506         | 506         | 506         |    506        | 506        | 506         | 506          | 506         | 506         |   506         | 506         | 506         | 506         | 506         |   506         | 506        | 506         | 506         |   506         | 506        | 506         |  506        |  506        |     506         | 506        | 506        | 506         | 506      |
| mean  |   0.0405441   |   0.113636 |   0.391378 |   0.06917  |   0.349167 |   0.521869 |   0.676364 |   0.242381 |   0.371713 |   0.422208 |   0.622929 |   0.898568 |   0.301409 |   0.0109722   |   9.60406e-05 |   0.0257337   |   0.00143467 |   0.0238415   |   0.0183107   |   0.0372891   |   0.00281243  |   0.0379193   |   0.0352036   |     0.0316994  |   0.0278785   |   0.0208831   |   0.0671994 |   0.013227  |   0.00533597 |   0.0110075 |   0.0690799 |   0.0384287 |   0.0571561 |   0.0147517 |   0.0244284 |   0.0497901  |   0.111515 |   0.0153087 |   0.216293  |    0.0310837 |   0.182354  |   0.191013 |   0.311627  |   0.0608358 |   0.202027  |   0.223426  |       0.265954  |   0.331054 |     0.147826  |   0.06917  |   0.0296642 |   0.0392118 |   0.0531419 |   0.0119516 |   0.0250043 |   0.0263027 |      0.0359936 |   0.065001 |    0.0181547 |   0.178655  |   0.172538  |   0.286623  |   0.0495814 |   0.184872  |   0.198549  |      0.227861 |   0.292931 |   0.132948  |   0.290436 |   0.343615 |   0.131772  |   0.183312  |   0.207717  |     0.314086 |   0.472896 |   0.141045  |   0.541341 |   0.122505  |   0.301362  |   0.332695  |      0.438753 |   0.58954  |   0.238202  |   0.0953416  |   0.0543142 |   0.0694861 |     0.140754  |   0.230621  |   0.0543406 |   0.281208  |   0.267554  |     0.271992  |   0.295355 |   0.14842   |   0.281505  |     0.297077  |   0.346735 |   0.161667  |    0.44098  |    0.550358 |       0.204698  |   0.860314 |   0.254263 |   0.129599  |  22.5328 |
| std   |   0.0966793   |   0.233225 |   0.251479 |   0.253994 |   0.238431 |   0.134627 |   0.289896 |   0.191482 |   0.378576 |   0.321636 |   0.230313 |   0.230205 |   0.197049 |   0.0648291   |   0.000250247 |   0.062712    |   0.00898116 |   0.0581617   |   0.0463915   |   0.0924745   |   0.0049385   |   0.0974924   |   0.0889416   |     0.0784633  |   0.0753905   |   0.0565657   |   0.182347  |   0.0269158 |   0.0525695  |   0.0227346 |   0.14823   |   0.075298  |   0.135534  |   0.0313895 |   0.0596261 |   0.115407   |   0.228912 |   0.0332429 |   0.221643  |    0.127433  |   0.189733  |   0.125512 |   0.265182  |   0.0373943 |   0.26616   |   0.250881  |       0.213118  |   0.23548  |     0.154603  |   0.253994 |   0.133553  |   0.150435  |   0.203818  |   0.0529388 |   0.130731  |   0.126511  |      0.144121  |   0.241227 |    0.0820745 |   0.218363  |   0.119523  |   0.249519  |   0.0252693 |   0.25223   |   0.229235  |      0.18405  |   0.213805 |   0.148619  |   0.151849 |   0.167321 |   0.112156  |   0.189972  |   0.161192  |     0.126537 |   0.178757 |   0.0790962 |   0.348882 |   0.0851951 |   0.363368  |   0.325121  |      0.275753 |   0.298802 |   0.211235  |   0.137083   |   0.0475539 |   0.0564224 |     0.12042   |   0.193054  |   0.0465894 |   0.427909  |   0.385317  |     0.322171  |   0.322821 |   0.213532  |   0.347008  |     0.284685  |   0.283915 |   0.194503  |    0.250593 |    0.252126 |       0.168367  |   0.265606 |   0.17851  |   0.161755  |   9.1971 |
| min   |   0           |   0        |   0        |   0        |   0        |   0        |   0        |   0        |   0        |   0        |   0        |   0        |   0        |   0           |   0           |   0           |   0          |   0           |   0           |   0           |   0           |   0           |   0           |     0          |   0           |   0           |   0         |   0         |   0          |   0         |   0         |   0         |   0         |   0         |   0         |   0          |   0        |   0         |   0         |    0         |   0         |   0        |   0         |   0         |   0         |   0         |       0         |   0        |     0         |   0        |   0         |   0         |   0         |   0         |   0         |   0         |      0         |   0        |    0         |   0         |   0         |   0         |   0         |   0         |   0         |      0        |   0        |   0         |   0        |   0        |   0         |   0         |   0         |     0        |   0        |   0         |   0        |   0         |   0         |   0         |      0        |   0        |   0         |   0          |   0         |   0         |     0         |   0         |   0         |   0         |   0         |     0         |   0        |   0         |   0         |     0         |   0        |   0         |    0        |    0        |       0         |   0        |   0        |   0         |   5      |
| 25%   |   0.000851131 |   0        |   0.173387 |   0        |   0.131687 |   0.445392 |   0.433831 |   0.088259 |   0.130435 |   0.175573 |   0.510638 |   0.94573  |   0.14404  |   7.24425e-07 |   0           |   0.000167673 |   0          |   0.000118937 |   0.000448103 |   0.000320818 |   0.000205612 |   0.000112198 |   0.000142086 |     0.00039178 |   0.000815959 |   0.000127461 |   0         |   0         |   0          |   0         |   0         |   0         |   0         |   0         |   0         |   0          |   0        |   0         |   0.0300631 |    0         |   0.0231406 |   0.089886 |   0.0673962 |   0.0338519 |   0.0223766 |   0.0278879 |       0.0930178 |   0.134191 |     0.0245209 |   0        |   0         |   0         |   0         |   0         |   0         |   0         |      0         |   0        |    0         |   0.0173415 |   0.0746142 |   0.0608278 |   0.0327655 |   0.0184291 |   0.0209688 |      0.070922 |   0.1118   |   0.0213077 |   0.198374 |   0.221581 |   0.0456982 |   0.0599003 |   0.0929205 |     0.226814 |   0.405647 |   0.0805736 |   0.18821  |   0.0646431 |   0.0471052 |   0.0689578 |      0.205382 |   0.320069 |   0.0636518 |   0.00778965 |   0.0206213 |   0.0331595 |     0.0586145 |   0.0722663 |   0.0243422 |   0.0170132 |   0.0233986 |     0.0485661 |   0.123761 |   0.0196786 |   0.0308257 |     0.0876238 |   0.158244 |   0.0261899 |    0.260751 |    0.399728 |       0.0714863 |   0.894405 |   0.117439 |   0.0207484 |  17.025  |
| 50%   |   0.00281208  |   0        |   0.338343 |   0        |   0.314815 |   0.507281 |   0.76828  |   0.188949 |   0.173913 |   0.272901 |   0.68617  |   0.986232 |   0.265728 |   7.90865e-06 |   0           |   0.000853921 |   0          |   0.000805938 |   0.00128546  |   0.00199646  |   0.00066502  |   0.000481721 |   0.000789136 |     0.00160868 |   0.00255719  |   0.000747999 |   0         |   0         |   0          |   0         |   0         |   0         |   0         |   0         |   0         |   0          |   0        |   0         |   0.114476  |    0         |   0.082478  |   0.153201 |   0.236242  |   0.0531752 |   0.0516384 |   0.0644714 |       0.193658  |   0.260022 |     0.0873539 |   0        |   0         |   0         |   0         |   0         |   0         |   0         |      0         |   0        |    0         |   0.0991084 |   0.14646   |   0.227639  |   0.0464339 |   0.0466989 |   0.072095  |      0.165485 |   0.252189 |   0.0766285 |   0.257334 |   0.350723 |   0.100943  |   0.0904804 |   0.145579  |     0.326742 |   0.483316 |   0.128217  |   0.590259 |   0.10377   |   0.126271  |   0.175501  |      0.394406 |   0.642122 |   0.174523  |   0.0357022  |   0.0394386 |   0.0532792 |     0.108425  |   0.179247  |   0.041124  |   0.0302457 |   0.0614836 |     0.116559  |   0.169477 |   0.0461537 |   0.0744748 |     0.142115  |   0.22541  |   0.0654239 |    0.470858 |    0.615559 |       0.155388  |   0.972654 |   0.219227 |   0.0706119 |  21.2    |
| 75%   |   0.0412585   |   0.125    |   0.646628 |   0        |   0.49177  |   0.586798 |   0.93898  |   0.369088 |   1        |   0.914122 |   0.808511 |   0.998298 |   0.420116 |   0.00170226  |   6.50108e-05 |   0.0267683   |   0          |   0.0254687   |   0.0167742   |   0.0342046   |   0.00326683  |   0.0409251   |   0.0374106   |     0.0330884  |   0.0172262   |   0.0138873   |   0.015625  |   0.0190048 |   0          |   0.0115226 |   0.0586858 |   0.0317096 |   0.0181524 |   0         |   0.0137405 |   0.00851064 |   0.125    |   0.0131705 |   0.418127  |    0         |   0.372395  |   0.294575 |   0.600844  |   0.0849565 |   0.646628  |   0.591097  |       0.522805  |   0.562738 |     0.239809  |   0        |   0         |   0         |   0         |   0         |   0         |   0         |      0         |   0        |    0         |   0.241837  |   0.239526  |   0.470758  |   0.0619161 |   0.376543  |   0.398753  |      0.352684 |   0.411523 |   0.205122  |   0.344332 |   0.45754  |   0.194311  |   0.260324  |   0.282164  |     0.408861 |   0.564968 |   0.187532  |   0.881684 |   0.157422  |   0.545057  |   0.630283  |      0.730296 |   0.856969 |   0.377253  |   0.13624    |   0.0708177 |   0.0938209 |     0.193043  |   0.36063   |   0.0670054 |   1         |   0.914122  |     0.808511  |   0.26087  |   0.161454  |   0.835619  |     0.739077  |   0.440063 |   0.256045  |    0.653689 |    0.758547 |       0.311613  |   0.996599 |   0.344749 |   0.176497  |  25      |
| max   |   1           |   1        |   1        |   1        |   1        |   1        |   1        |   1        |   1        |   1        |   1        |   1        |   1        |   1           |   0.00184094  |   0.646628    |   0.100895   |   0.588477    |   0.652807    |   0.916581    |   0.050577    |   1           |   0.914122    |     0.808511   |   1           |   0.50006     |   1         |   0.149648  |   0.9        |   0.112037  |   0.814208  |   0.38723   |   0.9       |   0.173913  |   0.403626  |   0.8        |   0.989914 |   0.270488  |   1         |    0.70088   |   0.70088   |   0.646628 |   0.987642  |   0.232879  |   0.646628  |   1         |       0.797872  |   1        |     0.771247  |   1        |   1         |   1         |   1         |   0.432431  |   1         |   0.914122  |      0.808511  |   1        |    0.692329  |   1         |   0.685185  |   1         |   0.142069  |   0.792181  |   0.72415   |      0.640487 |   1        |   0.767108  |   1        |   0.864452 |   0.63661   |   1         |   0.914122  |     0.808511 |   0.967547 |   0.414993  |   1        |   0.494893  |   1         |   0.987642  |      0.914894 |   1        |   1         |   1          |   0.269958  |   0.372429  |     0.859888  |   0.968632  |   0.350441  |   1         |   0.914122  |     0.808511  |   1        |   1         |   1         |     0.797872  |   1        |   0.914122  |    1        |    0.964446 |       0.82502   |   1        |   1        |   1         |  50      |
+-------+---------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+---------------+---------------+---------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+----------------+---------------+---------------+-------------+-------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+--------------+------------+-------------+-------------+--------------+-------------+------------+-------------+-------------+-------------+-------------+-----------------+------------+---------------+------------+-------------+-------------+-------------+-------------+-------------+-------------+----------------+------------+--------------+-------------+-------------+-------------+-------------+-------------+-------------+---------------+------------+-------------+------------+------------+-------------+-------------+-------------+--------------+------------+-------------+------------+-------------+-------------+-------------+---------------+------------+-------------+--------------+-------------+-------------+---------------+-------------+-------------+-------------+-------------+---------------+------------+-------------+-------------+---------------+------------+-------------+-------------+-------------+-----------------+------------+------------+-------------+----------+
</pre></div>
</div>
</div>
</div>
</section>
<section id="graficas-descriptivas">
<h3>Gráficas descriptivas<a class="headerlink" href="#graficas-descriptivas" title="Link to this heading">#</a></h3>
<p>Se realizará un gráfico decsriptivo analizando la distribución de las 103 variables predictoras de tal forma se peuda evidenciar su variabilidad o presencia de datos atípicos. También se analizará la distribución de la varible objetivo.</p>
<p><strong>Variables Predictoras</strong></p>
<p>Las distribuciones muestran una variabilidad significativa entre las distintas variables, con algunas que tienen una amplitud mayor (indicando una dispersión considerable) y otras que están más concentradas alrededor de un valor central. Algunas variables tienen una media que parece estar muy cercana a la mediana, lo que sugiere una distribución más simétrica, mientras que otras muestran asimetría, evidenciada por una separación significativa entre estos dos estadísticos.</p>
<p>Al observar la gráfica, se destacan algunas variables, como CRIM, ZN y INDUS, que presentan una mayor dispersión en comparación con otras. La variabilidad en estas variables es amplia, con una distribución que abarca un rango significativo de valores, lo que sugiere que los datos están más dispersos y tienen una mayor diversidad de observaciones.</p>
<p>En contraste, variables como NOX, AGE y TAX exhiben una distribución más concentrada, donde la dispersión es notablemente menor. Estas variables tienden a estar más agrupadas en torno a su mediana, lo que sugiere menos variabilidad en los datos y una menor cantidad de valores extremos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;MEDV&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: &gt;
</pre></div>
</div>
<img alt="_images/13820a2b25a80838c23f9872a9284d31649c490aa78c33118874d09beceb305c.png" src="_images/13820a2b25a80838c23f9872a9284d31649c490aa78c33118874d09beceb305c.png" />
</div>
</div>
<p><strong>Variable Objetivo</strong></p>
<p>En el diagrama de cajas y bigotes, se muestra la distribución del precio promedio de las viviendas en Boston, la variable objetivo (target) del conjunto de datos de Boston.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Mediana</span></code>: El valor central de la distribución, ubicado en torno a 21. Este valor indica que la mitad de las viviendas tienen un precio promedio menor y la otra mitad tiene un precio promedio mayor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Rango</span> <span class="pre">intercuartílico</span> <span class="pre">(IQR):</span></code> Se observa una concentración importante de los datos entre aproximadamente 17 y 25, lo que refleja que la mayoría de las viviendas están en este rango de precios.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Valores</span> <span class="pre">atípicos</span> <span class="pre">(outliers):</span></code> Existen múltiples valores atípicos en el extremo derecho, sobre todo a partir de los 35 hasta alcanzar el máximo posible de 50. Estos outliers representan viviendas que tienen un precio promedio significativamente más alto que el resto.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Mínimo</span> <span class="pre">y</span> <span class="pre">máximo</span> <span class="pre">(sin</span> <span class="pre">outliers):</span></code> El mínimo está cerca de 10 y el máximo (sin contar los outliers) alrededor de 30, lo que nos da una idea del rango en el que se sitúan los precios promedio de las viviendas en Boston.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">font_scale</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">],</span> <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;Set2&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Precio promedio de las viviendas en Boston&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Precio promedio de las viviendas en Boston&#39;)
</pre></div>
</div>
<img alt="_images/617da40894d86b23b43dc9bbe99d04b62559b2c2d424fcca2fe60777a299d5e5.png" src="_images/617da40894d86b23b43dc9bbe99d04b62559b2c2d424fcca2fe60777a299d5e5.png" />
</div>
</div>
</section>
<section id="multicolinealidad">
<h3>Multicolinealidad<a class="headerlink" href="#multicolinealidad" title="Link to this heading">#</a></h3>
<p>Se realiza una inspección de correlación para observar si existe algún tipo de muticolinealidad entre las variables del conjunto de datos. Posterior a ello se eliminan las variables consideradas como altamente correlacionadas entre si. Dada la distribución de las variables observadas mediante el gráfico de cajas y bigotes, podemos decir que existen correlaciones entre algunas variables basadas en la amplia distribución poseen, es decir, las variables con mayor variabilidad o dispersión y menor presencia de datos atípicos podrían estar más correlacionadas que el resto de las variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="c1"># Mostrar la matriz de correlación con texto más pequeño</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de correlación&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Título más pequeño</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># Tamaño del texto en el eje x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># Tamaño del texto en el eje y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1546294476037513c9ca87376d38e4508382a6488bf02483b611837ef10e773e.png" src="_images/1546294476037513c9ca87376d38e4508382a6488bf02483b611837ef10e773e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.outliers_influence</span> <span class="kn">import</span> <span class="n">variance_inflation_factor</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">VIF_calculation</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
    <span class="n">VIF</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="n">VIF</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span>
    <span class="n">VIF</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">variance_inflation_factor</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="n">VIF</span> <span class="o">=</span> <span class="n">VIF</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;VIF&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">VIF</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">delete_multicollinearity</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">target_name</span><span class="p">,</span> <span class="n">VIF_threshold</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">target_name</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Aquí usamos target_name para evitar el error</span>
    <span class="n">VIF_mat</span> <span class="o">=</span> <span class="n">VIF_calculation</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">n_VIF</span> <span class="o">=</span> <span class="n">VIF_mat</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">n_VIF</span> <span class="o">&lt;=</span> <span class="n">VIF_threshold</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is no multicollinearity!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">while</span> <span class="n">n_VIF</span> <span class="o">&gt;</span> <span class="n">VIF_threshold</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">VIF_mat</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">VIF_mat</span> <span class="o">=</span> <span class="n">VIF_calculation</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">n_VIF</span> <span class="o">=</span> <span class="n">VIF_mat</span><span class="p">[</span><span class="s2">&quot;VIF&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">display</span><span class="p">(</span><span class="n">VIF_mat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df_copy</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># Asegúrate de definir df_copy</span>
<span class="n">df_copy</span> <span class="o">=</span> <span class="n">delete_multicollinearity</span><span class="p">(</span><span class="n">df_copy</span><span class="p">,</span> <span class="s2">&quot;MEDV&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f9126293-5fa9-40a7-95d1-218d6e40d505" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>VIF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NOX*DIS</td>
      <td>9.734302</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AGE^2</td>
      <td>9.690087</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CHAS*RAD</td>
      <td>9.573889</td>
    </tr>
    <tr>
      <th>3</th>
      <td>INDUS*DIS</td>
      <td>9.231878</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CRIM*CHAS</td>
      <td>8.290902</td>
    </tr>
    <tr>
      <th>5</th>
      <td>CHAS*NOX</td>
      <td>7.310127</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ZN*NOX</td>
      <td>7.122937</td>
    </tr>
    <tr>
      <th>7</th>
      <td>INDUS^2</td>
      <td>6.736253</td>
    </tr>
    <tr>
      <th>8</th>
      <td>ZN*PTRATIO</td>
      <td>6.326790</td>
    </tr>
    <tr>
      <th>9</th>
      <td>RAD*B</td>
      <td>6.247725</td>
    </tr>
    <tr>
      <th>10</th>
      <td>CHAS*RM</td>
      <td>6.126564</td>
    </tr>
    <tr>
      <th>11</th>
      <td>CRIM*B</td>
      <td>6.102681</td>
    </tr>
    <tr>
      <th>12</th>
      <td>DIS^2</td>
      <td>5.996794</td>
    </tr>
    <tr>
      <th>13</th>
      <td>RM^2</td>
      <td>5.408660</td>
    </tr>
    <tr>
      <th>14</th>
      <td>ZN^2</td>
      <td>5.337285</td>
    </tr>
    <tr>
      <th>15</th>
      <td>ZN*INDUS</td>
      <td>5.178949</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NOX^2</td>
      <td>4.892713</td>
    </tr>
    <tr>
      <th>17</th>
      <td>ZN*RAD</td>
      <td>4.822439</td>
    </tr>
    <tr>
      <th>18</th>
      <td>ZN*LSTAT</td>
      <td>4.707706</td>
    </tr>
    <tr>
      <th>19</th>
      <td>ZN*TAX</td>
      <td>4.696180</td>
    </tr>
    <tr>
      <th>20</th>
      <td>CRIM^2</td>
      <td>4.653685</td>
    </tr>
    <tr>
      <th>21</th>
      <td>CRIM*ZN</td>
      <td>4.140952</td>
    </tr>
    <tr>
      <th>22</th>
      <td>CRIM*DIS</td>
      <td>3.745952</td>
    </tr>
    <tr>
      <th>23</th>
      <td>LSTAT^2</td>
      <td>3.302099</td>
    </tr>
    <tr>
      <th>24</th>
      <td>CHAS*LSTAT</td>
      <td>3.073722</td>
    </tr>
    <tr>
      <th>25</th>
      <td>ZN*CHAS</td>
      <td>2.015868</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f9126293-5fa9-40a7-95d1-218d6e40d505')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f9126293-5fa9-40a7-95d1-218d6e40d505 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f9126293-5fa9-40a7-95d1-218d6e40d505');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-cc6458b3-4f2f-43a0-89e1-37bf0b129b89">
  <button class="colab-df-quickchart" onclick="quickchart('df-cc6458b3-4f2f-43a0-89e1-37bf0b129b89')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-cc6458b3-4f2f-43a0-89e1-37bf0b129b89 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<p>Se realiza el proceso de eliminación del conjunto de datos las variables que presentan una alta multicolinealidad, dado que la mayoría de estas son producto de combinaciones aritmeticas entre las variables oríginales del conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_copy</span><span class="p">,</span> <span class="n">df_y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">correlation_matrix</span> <span class="o">=</span> <span class="n">df_copy</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">correlation_matrix</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Matriz de correlación&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Título más pequeño</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># Tamaño del texto en el eje x</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># Tamaño del texto en el eje y</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4b2ead6662bf374e3772994ba74e32a8222a140e6ee9790e9957ec10565effa2.png" src="_images/4b2ead6662bf374e3772994ba74e32a8222a140e6ee9790e9957ec10565effa2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;CRIM^2&#39;, &#39;CRIM*ZN&#39;, &#39;CRIM*CHAS&#39;, &#39;CRIM*DIS&#39;, &#39;CRIM*B&#39;, &#39;ZN^2&#39;,
       &#39;ZN*INDUS&#39;, &#39;ZN*CHAS&#39;, &#39;ZN*NOX&#39;, &#39;ZN*RAD&#39;, &#39;ZN*TAX&#39;, &#39;ZN*PTRATIO&#39;,
       &#39;ZN*LSTAT&#39;, &#39;INDUS^2&#39;, &#39;INDUS*DIS&#39;, &#39;CHAS*NOX&#39;, &#39;CHAS*RM&#39;, &#39;CHAS*RAD&#39;,
       &#39;CHAS*LSTAT&#39;, &#39;NOX^2&#39;, &#39;NOX*DIS&#39;, &#39;RM^2&#39;, &#39;AGE^2&#39;, &#39;DIS^2&#39;, &#39;RAD*B&#39;,
       &#39;LSTAT^2&#39;, &#39;MEDV&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="modelo-de-regresion-lineal-multiple">
<h2>Modelo de regresión Lineal Múltiple<a class="headerlink" href="#modelo-de-regresion-lineal-multiple" title="Link to this heading">#</a></h2>
<section id="modelo-realizado-con-funciones-de-libreria">
<h3>Modelo realizado con funciones de librería<a class="headerlink" href="#modelo-realizado-con-funciones-de-libreria" title="Link to this heading">#</a></h3>
<p>Se realiza el modelo de regresión lineal múltiple con base a las funciones de las librerías de python que no son manuales. Se obtuvo un coeficiente de determinación (<span class="math notranslate nohighlight">\(R^2\)</span>) cercano al 70%, un puntaje de la métrica de la raíz cuadrada del error cuadrático medio (RMSE) de 4.23, un error absoluto medio (MAE) de 2.56, un puntaje para el error cuadrático medio (MSE) de 22.3 y finalmente el error de porcentaje medio absoluto (MAPE) de 18.31%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;MEDV&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos los parámetros</span>
<span class="n">pipe_lr</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())])</span>
<span class="n">param_grid_lr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lr__fit_intercept&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Definimos los hiperparámetros</span>
<span class="n">grid_lr</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_lr</span><span class="p">,</span> <span class="n">param_grid_lr</span><span class="p">,</span> <span class="n">cv</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">grid_lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=Pipeline(steps=[(&#x27;lr&#x27;, LinearRegression())]),
             param_grid={&#x27;lr__fit_intercept&#x27;: [True, False]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" ><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5, estimator=Pipeline(steps=[(&#x27;lr&#x27;, LinearRegression())]),
             param_grid={&#x27;lr__fit_intercept&#x27;: [True, False]})</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" ><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Pipeline</label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[(&#x27;lr&#x27;, LinearRegression())])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" ><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;LinearRegression<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.linear_model.LinearRegression.html">?<span>Documentation for LinearRegression</span></a></label><div class="sk-toggleable__content fitted"><pre>LinearRegression()</pre></div> </div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: </span><span class="si">{</span><span class="n">grid_lr</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación de validación cruzada: </span><span class="si">{</span><span class="n">grid_lr</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: {&#39;lr__fit_intercept&#39;: True}
Mejor puntuación de validación cruzada: 0.6958551702035134
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_lr</span> <span class="o">=</span> <span class="n">grid_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">grid_lr</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">named_steps</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="metricas-del-modelo">
<h3>Métricas del modelo<a class="headerlink" href="#metricas-del-modelo" title="Link to this heading">#</a></h3>
<p><strong>Coeficiente de determinación <span class="math notranslate nohighlight">\(R^2 \)</span></strong></p>
<div class="math notranslate nohighlight">
\[R^2 = 1 - \frac{\sum_{i=1}^{n} (y_i - \hat{y}_i)^2}{\sum_{i=1}^{n} (y_i - \bar{y})^2}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lr</span><span class="p">)</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">best_model</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">best_model</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
</div>
<section id="rmse-root-mean-squared-error">
<h4>RMSE (Root Mean Squared Error)<a class="headerlink" href="#rmse-root-mean-squared-error" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[
RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lr</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="mae-mean-absolute-error">
<h3>MAE (Mean Absolute Error)<a class="headerlink" href="#mae-mean-absolute-error" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[MAE = \frac{1}{n} \sum_{i=1}^{n} |y_i - \hat{y}_i|
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mse-mean-squared-error">
<h3>MSE (Mean Squared Error)<a class="headerlink" href="#mse-mean-squared-error" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[MSE = \frac{1}{n} \sum_{i=1}^{n} (y_i - \hat{y}_i)^2\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="mape-mean-absolute-percentage-error">
<h3>MAPE (Mean Absolute Percentage Error)<a class="headerlink" href="#mape-mean-absolute-percentage-error" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[MAPE = \frac{100}{n} \sum_{i=1}^{n} \left| \frac{y_i - \hat{y}_i}{y_i} \right|
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_lr</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Crear los datos para la tabla con métricas</span>
<span class="n">table_data_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Linear Regression&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Crear los datos para la tabla con coeficientes e intercepto</span>
<span class="n">table_data_coefs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Intercepto&#39;</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Añadir los coeficientes con los nombres de las variables a la tabla</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># Nombres de las variables del conjunto de entrenamiento</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coef</span><span class="p">):</span>
    <span class="n">table_data_coefs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>

<span class="c1"># Mostrar las tablas usando tabulate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_metrics</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modelo&quot;</span><span class="p">,</span> <span class="s2">&quot;MAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R²&quot;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Coeficientes e Intercepto del modelo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_coefs</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parámetro&quot;</span><span class="p">,</span> <span class="s2">&quot;Valor&quot;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+--------+-------+--------+-------+------+
| Modelo            |   MAPE |   MAE |   RMSE |   MSE |   R² |
+===================+========+=======+========+=======+======+
| Linear Regression |  18.31 |  3.23 |   4.72 |  22.3 |  0.7 |
+-------------------+--------+-------+--------+-------+------+

Coeficientes e Intercepto del modelo:
+-------------+-------------+
| Parámetro   |       Valor |
|-------------+-------------|
| Intercepto  |   21.0028   |
| CRIM^2      |   12.944    |
| CRIM*ZN     | 1080.39     |
| CRIM*CHAS   |  357.005    |
| CRIM*DIS    | -426.316    |
| CRIM*B      |  -19.3523   |
| ZN^2        |    5.91153  |
| ZN*INDUS    |  -13.6239   |
| ZN*CHAS     |   -1.92829  |
| ZN*NOX      |   55.3212   |
| ZN*RAD      |  -11.6295   |
| ZN*TAX      |   -6.00533  |
| ZN*PTRATIO  |   -3.18556  |
| ZN*LSTAT    |  -28.0831   |
| INDUS^2     |    0.339515 |
| INDUS*DIS   |   -4.79366  |
| CHAS*NOX    |   -9.52436  |
| CHAS*RM     |    8.31635  |
| CHAS*RAD    |  -15.0821   |
| CHAS*LSTAT  |   -0.342601 |
| NOX^2       |   -3.55947  |
| NOX*DIS     |  -42.347    |
| RM^2        |   29.3754   |
| AGE^2       |   -3.28959  |
| DIS^2       |   -3.41756  |
| RAD*B       |    4.13679  |
| LSTAT^2     |  -13.2326   |
+-------------+-------------+
</pre></div>
</div>
</div>
</div>
<section id="modelo-realizado-manualmente">
<h4>Modelo realizado manualmente<a class="headerlink" href="#modelo-realizado-manualmente" title="Link to this heading">#</a></h4>
<p>Se realiza el modelo de regresión lineal múltiple manualmente con los ciclos requeridos. Se obtuvo un coeficiente de determinación (<span class="math notranslate nohighlight">\(R^2\)</span>) cercano al 70%, un puntaje de la métrica de la raíz cuadrada del error cuadrático medio (RMSE) de 4.72, un error absoluto medio (MAE) de 2.56, un puntaje para el error cuadrático medio (MSE) de 22.3 y finalmente el error de porcentaje medio absoluto (MAPE) de 18.31%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">best_score_lr</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>  <span class="c1"># Para almacenar el mejor score (en este caso, R²)</span>
<span class="n">best_params_lr</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># Para almacenar los mejores hiperparámetros</span>
<span class="n">best_model_lr</span> <span class="o">=</span> <span class="kc">None</span>     <span class="c1"># Para almacenar el mejor modelo</span>
<span class="n">best_y_pred</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">fit_intercept_options</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>  <span class="c1"># Hiperparámetro a probar</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">fit_intercept</span> <span class="ow">in</span> <span class="n">fit_intercept_options</span><span class="p">:</span>
  <span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
      <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
      <span class="p">(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="n">fit_intercept</span><span class="p">))</span>
  <span class="p">])</span>

  <span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
  <span class="n">y_pred</span> <span class="o">=</span> <span class="n">pipe</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
  <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">r2</span> <span class="o">&gt;</span> <span class="n">best_score_lr</span><span class="p">:</span>
    <span class="n">best_score_lr</span> <span class="o">=</span> <span class="n">r2</span>
    <span class="n">best_params_lr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fit_intercept&#39;</span><span class="p">:</span> <span class="n">fit_intercept</span><span class="p">}</span>
    <span class="n">best_model_lr</span> <span class="o">=</span> <span class="n">pipe</span>
    <span class="n">best_y_pred</span> <span class="o">=</span> <span class="n">y_pred_lr</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_y_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">best_y_pred</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">best_y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Obtener los coeficientes e intercepto del mejor modelo</span>
<span class="n">coef</span> <span class="o">=</span> <span class="n">best_model_lr</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">coef_</span>
<span class="n">intercept</span> <span class="o">=</span> <span class="n">best_model_lr</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">intercept_</span>

<span class="c1"># Crear los datos para la tabla con métricas</span>
<span class="n">table_data_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Linear Regression&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">best_score_lr</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Crear los datos para la tabla con coeficientes e intercepto</span>
<span class="n">table_data_coefs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Intercepto&#39;</span><span class="p">,</span> <span class="n">intercept</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Añadir los coeficientes con los nombres de las variables a la tabla</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">columns</span>  <span class="c1"># Nombres de las variables del conjunto de entrenamiento</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">coef</span><span class="p">):</span>
    <span class="n">table_data_coefs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">feature_names</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>

<span class="c1"># Mostrar las tablas usando tabulate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_metrics</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modelo&quot;</span><span class="p">,</span> <span class="s2">&quot;MAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R²&quot;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Coeficientes e Intercepto del modelo:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_coefs</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Parámetro&quot;</span><span class="p">,</span> <span class="s2">&quot;Valor&quot;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;psql&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+-------------------+--------+-------+--------+-------+------+
| Modelo            |   MAPE |   MAE |   RMSE |   MSE |   R² |
+===================+========+=======+========+=======+======+
| Linear Regression |  18.31 |  3.23 |   4.72 |  22.3 |  0.7 |
+-------------------+--------+-------+--------+-------+------+

Coeficientes e Intercepto del modelo:
+-------------+------------+
| Parámetro   |      Valor |
|-------------+------------|
| Intercepto  | 22.7965    |
| CRIM^2      |  0.912764  |
| CRIM*ZN     |  0.2863    |
| CRIM*CHAS   |  3.57308   |
| CRIM*DIS    | -2.16192   |
| CRIM*B      | -1.53143   |
| ZN^2        |  1.05286   |
| ZN*INDUS    | -0.361465  |
| ZN*CHAS     | -0.106697  |
| ZN*NOX      |  1.29635   |
| ZN*RAD      | -0.361505  |
| ZN*TAX      | -0.377784  |
| ZN*PTRATIO  | -0.352676  |
| ZN*LSTAT    | -0.974239  |
| INDUS^2     |  0.0748774 |
| INDUS*DIS   | -0.177149  |
| CHAS*NOX    | -1.39442   |
| CHAS*RM     |  1.30777   |
| CHAS*RAD    | -2.17736   |
| CHAS*LSTAT  | -0.0272258 |
| NOX^2       | -0.803649  |
| NOX*DIS     | -1.06967   |
| RM^2        |  4.60492   |
| AGE^2       | -1.13574   |
| DIS^2       | -0.467161  |
| RAD*B       |  1.31202   |
| LSTAT^2     | -2.10869   |
+-------------+------------+
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="modelo-de-regresion-k-nn">
<h2>Modelo de regresión K-NN<a class="headerlink" href="#modelo-de-regresion-k-nn" title="Link to this heading">#</a></h2>
<p><strong>Modelo con funciones automáticas</strong></p>
<p>Se realiza el modelo de regresión del K-Vecino más cercano con base a las funciones de las librerías de python que no son manuales. Se determinó que el númro de vecinos óptimos es 2 y se obtuvo un coeficiente de determinación (<span class="math notranslate nohighlight">\(R^2\)</span>) cercano al 76%, un puntaje de la métrica de la raíz cuadrada del error cuadrático medio (RMSE) de 4.23, un error absoluto medio (MAE) de 2.52, un puntaje para el error cuadrático medio (MSE) de 17.52 y finalmente el error de porcentaje medio absoluto (MAPE) de 13.15%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">datos</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;MEDV&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">datos</span><span class="p">[</span><span class="s1">&#39;MEDV&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pipe_knn</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsRegressor</span><span class="p">())</span>  <span class="c1"># Modelo KNN</span>
<span class="p">])</span>
<span class="n">param_grid_knn</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">)}</span>
<span class="c1"># Definir la métrica de scoring (en este caso, queremos minimizar el MSE, por eso usamos &quot;neg_mean_squared_error&quot;)</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="n">make_scorer</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">greater_is_better</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grid_knn</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe_knn</span><span class="p">,</span> <span class="n">param_grid_knn</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">grid_knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exception ignored on calling ctypes callback function: &lt;function ThreadpoolController._find_libraries_with_dl_iterate_phdr.&lt;locals&gt;.match_library_callback at 0x7fdd46ad9900&gt;
Traceback (most recent call last):
  File &quot;/usr/local/lib/python3.10/dist-packages/threadpoolctl.py&quot;, line 1005, in match_library_callback
    self._make_controller_from_path(filepath)
  File &quot;/usr/local/lib/python3.10/dist-packages/threadpoolctl.py&quot;, line 1175, in _make_controller_from_path
    lib_controller = controller_class(
  File &quot;/usr/local/lib/python3.10/dist-packages/threadpoolctl.py&quot;, line 114, in __init__
    self.dynlib = ctypes.CDLL(filepath, mode=_RTLD_NOLOAD)
  File &quot;/usr/lib/python3.10/ctypes/__init__.py&quot;, line 374, in __init__
    self._handle = _dlopen(self._name, mode)
OSError: dlopen() error
</pre></div>
</div>
<div class="output text_html"><style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=5, estimator=Pipeline(steps=[(&#x27;knn&#x27;, KNeighborsRegressor())]),
             param_grid={&#x27;knn__n_neighbors&#x27;: range(1, 20)},
             scoring=make_scorer(mean_squared_error, greater_is_better=False, response_method=&#x27;predict&#x27;))</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" ><label for="sk-estimator-id-4" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;GridSearchCV<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.model_selection.GridSearchCV.html">?<span>Documentation for GridSearchCV</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>GridSearchCV(cv=5, estimator=Pipeline(steps=[(&#x27;knn&#x27;, KNeighborsRegressor())]),
             param_grid={&#x27;knn__n_neighbors&#x27;: range(1, 20)},
             scoring=make_scorer(mean_squared_error, greater_is_better=False, response_method=&#x27;predict&#x27;))</pre></div> </div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" ><label for="sk-estimator-id-5" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">best_estimator_: Pipeline</label><div class="sk-toggleable__content fitted"><pre>Pipeline(steps=[(&#x27;knn&#x27;, KNeighborsRegressor(n_neighbors=2))])</pre></div> </div></div><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-6" type="checkbox" ><label for="sk-estimator-id-6" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;KNeighborsRegressor<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.neighbors.KNeighborsRegressor.html">?<span>Documentation for KNeighborsRegressor</span></a></label><div class="sk-toggleable__content fitted"><pre>KNeighborsRegressor(n_neighbors=2)</pre></div> </div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Mostrar los mejores hiperparámetros encontrados</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejores hiperparámetros: </span><span class="si">{</span><span class="n">grid_knn</span><span class="o">.</span><span class="n">best_params_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación de validación cruzada: </span><span class="si">{</span><span class="n">grid_knn</span><span class="o">.</span><span class="n">best_score_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Hacer predicciones con el mejor modelo encontrado</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear los datos para la tabla con métricas</span>
<span class="n">table_data_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;K-NN&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Crear los datos para la tabla con los mejores hiperparámetros</span>
<span class="n">best_params_knn</span> <span class="o">=</span> <span class="n">grid_knn</span><span class="o">.</span><span class="n">best_params_</span>
<span class="n">table_data_params</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Mejores Hiperparámetros&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="n">best_params_knn</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Mostrar la tabla con métricas usando tabulate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_metrics</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modelo&quot;</span><span class="p">,</span> <span class="s2">&quot;MAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R²&quot;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="p">))</span>

<span class="c1"># Mostrar la tabla con los mejores hiperparámetros</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores hiperparámetros:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;firstrow&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores hiperparámetros: {&#39;knn__n_neighbors&#39;: 2}
Mejor puntuación de validación cruzada: -18.9855549382716
+----------+--------+-------+--------+-------+------+
| Modelo   |   MAPE |   MAE |   RMSE |   MSE |   R² |
+==========+========+=======+========+=======+======+
| K-NN     |  13.15 |  2.52 |   4.23 | 17.92 | 0.76 |
+----------+--------+-------+--------+-------+------+

Mejores hiperparámetros:
+----------+---------------------------+
| Modelo   | Mejores Hiperparámetros   |
+==========+===========================+
| K-NN     | {&#39;knn__n_neighbors&#39;: 2}   |
+----------+---------------------------+
</pre></div>
</div>
</div>
</div>
<section id="modelo-knn-realizado-manualmente">
<h3>Modelo KNN realizado manualmente<a class="headerlink" href="#modelo-knn-realizado-manualmente" title="Link to this heading">#</a></h3>
<p>Se realiza el modelo de regresión del K-Vecino más cercano manualmente paso a paso. Se determinó que el númro de vecinos óptimos es 2 y se obtuvo un coeficiente de determinación (<span class="math notranslate nohighlight">\(R^2\)</span>) cercano al 76%, un puntaje de la métrica de la raíz cuadrada del error cuadrático medio (RMSE) de 4.23, un error absoluto medio (MAE) de 2.52, un puntaje para el error cuadrático medio (MSE) de 17.92 y finalmente el error de porcentaje medio absoluto (MAPE) de 13.15%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Inicializar la mejor puntuación</span>
<span class="n">best_score_knn</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>  <span class="c1"># Cambiamos a -inf porque estamos maximizando el score negativo (mse negativo)</span>
<span class="n">best_n_neighbors</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1"># Para almacenar el mejor valor de n_neighbors</span>

<span class="k">for</span> <span class="n">n_neighbors</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">)</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">knn</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;neg_mean_squared_error&#39;</span><span class="p">)</span>
    <span class="n">mean_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">mean_score</span> <span class="o">&gt;</span> <span class="n">best_score_knn</span><span class="p">:</span>
        <span class="n">best_score_knn</span> <span class="o">=</span> <span class="n">mean_score</span>
        <span class="n">best_n_neighbors</span> <span class="o">=</span> <span class="n">n_neighbors</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor número de vecinos: </span><span class="si">{</span><span class="n">best_n_neighbors</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mejor puntuación de validación cruzada: </span><span class="si">{</span><span class="n">best_score_knn</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor número de vecinos: 2
Mejor puntuación de validación cruzada: -18.9855549382716
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">best_knn_model</span> <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="n">best_n_neighbors</span><span class="p">)</span>
<span class="n">best_knn_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-container-id-3 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: black;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-3 {
  color: var(--sklearn-color-text);
}

#sk-container-id-3 pre {
  padding: 0;
}

#sk-container-id-3 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-3 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-3 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-3 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-3 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-3 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-3 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-3 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-3 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-3 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-3 label.sk-toggleable__label {
  cursor: pointer;
  display: block;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
}

#sk-container-id-3 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-3 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-3 div.sk-label label.sk-toggleable__label,
#sk-container-id-3 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-3 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-3 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-3 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-3 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-3 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 1ex;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-3 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-3 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-3 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-3 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KNeighborsRegressor(n_neighbors=2)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-7" type="checkbox" checked><label for="sk-estimator-id-7" class="sk-toggleable__label fitted sk-toggleable__label-arrow fitted">&nbsp;&nbsp;KNeighborsRegressor<a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.5/modules/generated/sklearn.neighbors.KNeighborsRegressor.html">?<span>Documentation for KNeighborsRegressor</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></label><div class="sk-toggleable__content fitted"><pre>KNeighborsRegressor(n_neighbors=2)</pre></div> </div></div></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">best_knn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
<span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_test</span> <span class="o">-</span> <span class="n">y_pred_knn</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_test</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Crear los datos para la tabla con métricas</span>
<span class="n">table_data_metrics</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;K-NN&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mape</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">r2</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Mostrar los mejores hiperparámetros encontrados manualmente</span>
<span class="n">best_params_knn</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_neighbors&#39;</span><span class="p">:</span> <span class="n">best_n_neighbors</span><span class="p">}</span>

<span class="c1"># Crear los datos para la tabla con los mejores hiperparámetros</span>
<span class="n">table_data_params</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Modelo&#39;</span><span class="p">,</span> <span class="s1">&#39;Mejores Hiperparámetros&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="n">best_params_knn</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Mostrar la tabla con métricas usando tabulate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_metrics</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Modelo&quot;</span><span class="p">,</span> <span class="s2">&quot;MAPE&quot;</span><span class="p">,</span> <span class="s2">&quot;MAE&quot;</span><span class="p">,</span> <span class="s2">&quot;RMSE&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span><span class="p">,</span> <span class="s2">&quot;R²&quot;</span><span class="p">],</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="p">))</span>

<span class="c1"># Mostrar la tabla con los mejores hiperparámetros</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores hiperparámetros:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">table_data_params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">&quot;firstrow&quot;</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">&quot;grid&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------+--------+-------+--------+-------+------+
| Modelo   |   MAPE |   MAE |   RMSE |   MSE |   R² |
+==========+========+=======+========+=======+======+
| K-NN     |  13.15 |  2.52 |   4.23 | 17.92 | 0.76 |
+----------+--------+-------+--------+-------+------+

Mejores hiperparámetros:
+----------+---------------------------+
| Modelo   | Mejores Hiperparámetros   |
+==========+===========================+
| K-NN     | {&#39;n_neighbors&#39;: 2}        |
+----------+---------------------------+
</pre></div>
</div>
</div>
</div>
</section>
<section id="graficas-conjunto-de-entrenamiento-y-prueba">
<h3>Gráficas conjunto de entrenamiento y prueba<a class="headerlink" href="#graficas-conjunto-de-entrenamiento-y-prueba" title="Link to this heading">#</a></h3>
<p><strong>Modelo de regresión lineal</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_pred_lr</span> <span class="o">=</span> <span class="n">grid_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_test_pred_lr</span> <span class="o">=</span> <span class="n">grid_lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Función para graficar los resultados</span>
<span class="k">def</span> <span class="nf">plot_predictions</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Graficamos el conjunto de entrenamiento</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> - Entrenamiento&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Valores reales&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Valores predichos&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Graficamos el conjunto de prueba</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> - Prueba&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Valores reales&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Valores predichos&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Graficar las predicciones para el mejor modelo de Regresión Lineal</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_lr</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_lr</span><span class="p">,</span> <span class="s2">&quot;Mejor Regresión Lineal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c38bd39bf2a13bcf45128dc3f685433a04f8ee35e8cce1756de542737ca23c4a.png" src="_images/c38bd39bf2a13bcf45128dc3f685433a04f8ee35e8cce1756de542737ca23c4a.png" />
</div>
</div>
<p><strong>Modelo de regresión KNN</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">y_train_pred_knn</span> <span class="o">=</span> <span class="n">best_knn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">y_test_pred_knn</span> <span class="o">=</span> <span class="n">best_knn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_predictions</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Graficamos el conjunto de entrenamiento</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_train</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> - Entrenamiento&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Valores reales&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Valores predichos&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Graficamos el conjunto de prueba</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Predicho&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">y_test</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_test</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Original&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2"> - Prueba&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Valores reales&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Valores predichos&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Graficar las predicciones para el mejor modelo de K-NN</span>
<span class="n">plot_predictions</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">y_train_pred_knn</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred_knn</span><span class="p">,</span> <span class="s2">&quot;Mejor K-NN&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/741a569c2e8a91307fd38581b6a44935eb73841066980d93692944b85e29d795.png" src="_images/741a569c2e8a91307fd38581b6a44935eb73841066980d93692944b85e29d795.png" />
</div>
</div>
</section>
</section>
<section id="conclusiones">
<h2>Conclusiones<a class="headerlink" href="#conclusiones" title="Link to this heading">#</a></h2>
<p>Para el modelo K-NN, el valor de R² es 0.7556, mientras que para la Regresión Lineal es 0.6960. Un valor más cercano a 1 indica un mejor ajuste, lo que sugiere que K-NN tiene un ajuste ligeramente mejor que la Regresión Lineal en este caso.</p>
<p>En la métrica RMSE para K-NN, el RMSE es 4.23, mientras que para la Regresión Lineal es 4.72. El modelo K-NN tiene un error más bajo, lo que significa que las predicciones tienden a estar más cerca de los valores reales en comparación con la Regresión Lineal.</p>
<p>De acuerdo con las métricas R² y RMSE, el modelo K-NN parece ser la mejor opción en este caso, ya que tiene un mejor ajuste a los datos (mayor R²) y un error de predicción más bajo (RMSE más bajo).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">r2_score</span>

<span class="k">def</span> <span class="nf">calculate_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="c1"># Calculamos las métricas para las predicciones dadas</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">y_true</span> <span class="o">-</span> <span class="n">y_pred</span><span class="p">)</span> <span class="o">/</span> <span class="n">y_true</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="n">mae</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="n">mse</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="n">rmse</span><span class="p">,</span> <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="n">mape</span><span class="p">,</span> <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">}</span>


<span class="n">metrics_knn</span> <span class="o">=</span> <span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">)</span>
<span class="n">metrics_lr</span> <span class="o">=</span> <span class="n">calculate_metrics</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_lr</span><span class="p">)</span>

<span class="n">df_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Linear Regression&#39;</span><span class="p">],</span>
    <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metrics_knn</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">],</span> <span class="n">metrics_lr</span><span class="p">[</span><span class="s1">&#39;MAPE&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metrics_knn</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">],</span> <span class="n">metrics_lr</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metrics_knn</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">],</span> <span class="n">metrics_lr</span><span class="p">[</span><span class="s1">&#39;RMSE&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metrics_knn</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">],</span> <span class="n">metrics_lr</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">]],</span>
    <span class="s1">&#39;R²&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">metrics_knn</span><span class="p">[</span><span class="s1">&#39;R²&#39;</span><span class="p">],</span> <span class="n">metrics_lr</span><span class="p">[</span><span class="s1">&#39;R²&#39;</span><span class="p">]]</span>
<span class="p">})</span>

<span class="n">df_metrics</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-89cac318-9a3e-470f-acea-23f395a55475" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Modelo</th>
      <th>MAPE</th>
      <th>MAE</th>
      <th>RMSE</th>
      <th>MSE</th>
      <th>R²</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K-NN</td>
      <td>13.152268</td>
      <td>2.521078</td>
      <td>4.233593</td>
      <td>17.923309</td>
      <td>0.755593</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Linear Regression</td>
      <td>18.306898</td>
      <td>3.226430</td>
      <td>4.721888</td>
      <td>22.296224</td>
      <td>0.695962</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-89cac318-9a3e-470f-acea-23f395a55475')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-89cac318-9a3e-470f-acea-23f395a55475 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-89cac318-9a3e-470f-acea-23f395a55475');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c5d06246-bf7a-423e-bc23-f8997e14a049">
  <button class="colab-df-quickchart" onclick="quickchart('df-c5d06246-bf7a-423e-bc23-f8997e14a049')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c5d06246-bf7a-423e-bc23-f8997e14a049 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_f7a3a591-ebc9-4eb5-a0c1-0792db326f5f">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_metrics')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_f7a3a591-ebc9-4eb5-a0c1-0792db326f5f button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_metrics');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ejercicio_1parte_1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Breast Cancer</p>
      </div>
    </a>
    <a class="right-next"
       href="Datos_Belka%28EDA_Modelo%29.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Análisis del Problema de Aplicación</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias-y-paquetes-necesarios">Librerías y paquetes necesarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-exploratorio-de-los-datos-eda">Análisis Exploratorio de los datos - EDA</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#importamos-el-conjunto-de-datos">Importamos el conjunto de datos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nombres-de-las-variables">Nombres de las variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-descriptivas">Gráficas descriptivas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad">Multicolinealidad</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-lineal-multiple">Modelo de regresión Lineal Múltiple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-realizado-con-funciones-de-libreria">Modelo realizado con funciones de librería</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metricas-del-modelo">Métricas del modelo</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#rmse-root-mean-squared-error">RMSE (Root Mean Squared Error)</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mae-mean-absolute-error">MAE (Mean Absolute Error)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mse-mean-squared-error">MSE (Mean Squared Error)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mape-mean-absolute-percentage-error">MAPE (Mean Absolute Percentage Error)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-realizado-manualmente">Modelo realizado manualmente</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-k-nn">Modelo de regresión K-NN</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-knn-realizado-manualmente">Modelo KNN realizado manualmente</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-conjunto-de-entrenamiento-y-prueba">Gráficas conjunto de entrenamiento y prueba</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusiones">Conclusiones</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kelly Beltran y Henry Saenz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>