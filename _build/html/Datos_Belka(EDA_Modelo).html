
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Análisis del Problema de Aplicación &#8212; Primer parcial ML</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Datos_Belka(EDA_Modelo)';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Ejercicio 2" href="Ejercicio_2parte_2%28EDA%29.html" />
    <link rel="prev" title="Ejercicio 1 parte 2" href="Ejercicio_1parte_2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Primer parcial ML - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Primer parcial ML - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Primer parcial
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Ejercicio_1parte_1.html">Breast Cancer</a></li>


<li class="toctree-l1"><a class="reference internal" href="Ejercicio_1parte_2.html">Ejercicio 1 parte 2</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Análisis del Problema de Aplicación</a></li>




<li class="toctree-l1"><a class="reference internal" href="Ejercicio_2parte_2%28EDA%29.html">Ejercicio 2</a></li>

<li class="toctree-l1"><a class="reference internal" href="Ejercicio_4.html">Ejericico 4</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FDatos_Belka(EDA_Modelo).html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Datos_Belka(EDA_Modelo).ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Análisis del Problema de Aplicación</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Análisis del Problema de Aplicación</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerias</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-del-dataset-original">Descripción del Dataset original</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-entrenamiento">Datos de entrenamiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-prueba">Datos de prueba</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptiva-para-variables-categoricas">Descriptiva para Variables Categóricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptiva-para-la-variable-objetivo">Descriptiva para la Variable Objetivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-faltantes">Datos Faltantes</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modificacion-del-dataset">Modificacion del dataset</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#division-de-la-base-de-datos">Division de la base de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extracion-de-datos">Extración de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proteina-seh">Proteina sEH</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proteina-hsa">Proteina HSA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proteina-brd4">Proteina BRD4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codificar-variables-categoricas">Codificar variables categoricas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Proteina sEH</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Proteina HSA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Proteina BRD4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-chi-cuadrado-para-multicolinealidad-entre-variables-categoricas">Prueba de Chi-Cuadrado para Multicolinealidad (entre Variables Categóricas)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-clasificacion">Modelos de clasificación</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Proteina sEH</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Proteina HSA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Proteina BRD4</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analisis-del-problema-de-aplicacion">
<h1>Análisis del Problema de Aplicación<a class="headerlink" href="#analisis-del-problema-de-aplicacion" title="Link to this heading">#</a></h1>
<p>Los fármacos de moléculas pequeñas son cruciales para interactuar con proteínas celulares y modular sus funciones, a menudo dirigidos a inhibir proteínas involucradas en enfermedades.</p>
<p>El conjunto de datos “Big Encoded Library for Chemical Assessment” (BELKA), creado por Leash Biosciences, contiene información sobre moléculas pequeñas y su capacidad para interactuar con tres proteínas objetivo, utilizando la tecnología de biblioteca química codificada por ADN (DEL).</p>
<p>Identificar estas moléculas a través de métodos tradicionales es un proceso laborioso por eso, el objetivo es utilizar técnicas de aprendizaje automático (ML) para predecir la afinidad de unión de compuestos químicos a proteínas, aprovechando los avances en ML para realizar búsquedas eficientes en el vasto espacio químico. Este concurso busca democratizar el descubrimiento computacional de fármacos y contribuir al desarrollo de nuevos tratamientos médicos.</p>
<p>La fuente de los datos es el concurso NeurIPS 2024 en Kaggle, titulado “Predict New Medicines with BELKA”.</p>
<section id="librerias">
<h2>Librerias<a class="headerlink" href="#librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span>  <span class="n">RocCurveDisplay</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span><span class="p">,</span><span class="n">chi2</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">f1_score</span><span class="p">,</span> <span class="n">roc_auc_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span><span class="n">confusion_matrix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\dask\dataframe\_pyarrow_compat.py:23: UserWarning: You are using pyarrow version 11.0.0 which is known to be insecure. See https://www.cve.org/CVERecord?id=CVE-2023-47248 for further details. Please upgrade to pyarrow&gt;=14.0.1 or install pyarrow-hotfix to patch your current version.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<p>Ahora accedemos a los datos almacenados en el archivo “train.csv” y almacenarlos en el DataFrame llamado ‘medicinas’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">KELLY</span><span class="se">\\</span><span class="s2">Downloads</span><span class="se">\\</span><span class="s2">leash-BELKA</span><span class="se">\\</span><span class="s2">train.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>También se ha cargado un archivo CSV llamado “test.csv” en un DataFrame llamado ‘med_test’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">KELLY</span><span class="se">\\</span><span class="s2">Downloads</span><span class="se">\\</span><span class="s2">leash-BELKA</span><span class="se">\\</span><span class="s2">test.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>En este paso, se están concatenando dos conjuntos de datos, ‘medicinas’ y ‘med_test’, utilizando la función pd.concat(), lo que permite combinar ambos DataFrames en uno solo llamado ‘completo’. Al final nos muestras las dimensiones del Dataframe que son 296921726 filas, con 7 columnas.</p>
<p>Explicación corta de cada variable:</p>
<ul class="simple">
<li><p><strong>id</strong>: Identificador único para el par de moléculas y proteínas.</p></li>
<li><p><strong>buildingblock1_smiles</strong>: Estructura química del primer bloque en formato SMILES.</p></li>
<li><p><strong>buildingblock2_smiles</strong>: Estructura química del segundo bloque en formato SMILES.</p></li>
<li><p><strong>buildingblock3_smiles</strong>: Estructura química del tercer bloque en formato SMILES.</p></li>
<li><p><strong>molecule_smiles</strong>: Estructura de la molécula completa que incluye los tres bloques y un enlace de ADN representado por [Dy].</p></li>
<li><p><strong>protein_name</strong>: Nombre de la proteína diana.</p></li>
<li><p><strong>binds</strong>: Variable objetivo binaria que indica si la molécula se une a la proteína (1) o no (0).</p></li>
</ul>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="descripcion-del-dataset-original">
<h1>Descripción del Dataset original<a class="headerlink" href="#descripcion-del-dataset-original" title="Link to this heading">#</a></h1>
<section id="datos-de-entrenamiento">
<h2>Datos de entrenamiento<a class="headerlink" href="#datos-de-entrenamiento" title="Link to this heading">#</a></h2>
<p>Se mostrarán las caracteristicas de el Dataframe ‘Medicinas’ de emtrenamiento y primero visualizaremos las primeras 5 observaciones. Esto te permite visualizar un fragmento para entender su estructura y contenido inicial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">medicinas</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>C#CCOc1ccc(CNc2nc(NCC3CCCN3c3cccnn3)nc(N[C@@H]...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3cccc(Br)n3)nc(N[C@@H](CC...</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3cccc(Br)n3)nc(N[C@@H](CC...</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>C#CCOc1ccc(CNc2nc(NCc3cccc(Br)n3)nc(N[C@@H](CC...</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A continuación se muestra la información concisa de la estructura del DataFrame, incluyendo el número de observaciones, el número de columnas, y el tipo de datos de cada columna.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 295246830 entries, 0 to 295246829
Data columns (total 7 columns):
 #   Column                 Dtype 
---  ------                 ----- 
 0   id                     int64 
 1   buildingblock1_smiles  object
 2   buildingblock2_smiles  object
 3   buildingblock3_smiles  object
 4   molecule_smiles        object
 5   protein_name           object
 6   binds                  int64 
dtypes: int64(2), object(5)
memory usage: 15.4+ GB
</pre></div>
</div>
</div>
</div>
<p>El DataFrame completo contiene un total de 295,246,830 observaciones y 7 variables, las columnas <strong>object</strong> indican datos de texto o cadenas, mientras que las columnas <strong>int64</strong> son de tipo entero.</p>
<p>El DataFrame ‘medicinas’(Train) consta de 295,246,830 observaciones y 7 columnas, presenta tanto datos numéricos como categóricos, y no se identificaron datos faltantes en el análisis preliminar. Debido a la gran cantidad de datos se planea encontrar una manera de disminuirna y quedarnos con un dataset final para el modelo</p>
</section>
<section id="datos-de-prueba">
<h2>Datos de prueba<a class="headerlink" href="#datos-de-prueba" title="Link to this heading">#</a></h2>
<p>El DataFrame ‘med_test’ contiene 1,674,896 filas y 6 columnas. ‘med_test’ no incluye la columna binds, que es una variable numérica utilizada para indicar la unión en el conjunto de entrenamiento.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">med_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>295246830</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>295246831</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>295246832</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>3</th>
      <td>295246833</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ncnc3c2...</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>295246834</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ncnc3c2...</td>
      <td>HSA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_test</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1674896 entries, 0 to 1674895
Data columns (total 6 columns):
 #   Column                 Non-Null Count    Dtype 
---  ------                 --------------    ----- 
 0   id                     1674896 non-null  int64 
 1   buildingblock1_smiles  1674896 non-null  object
 2   buildingblock2_smiles  1674896 non-null  object
 3   buildingblock3_smiles  1674896 non-null  object
 4   molecule_smiles        1674896 non-null  object
 5   protein_name           1674896 non-null  object
dtypes: int64(1), object(5)
memory usage: 76.7+ MB
</pre></div>
</div>
</div>
</div>
<p>El DataFrame completo contiene un total de 1,674,896 observaciones y 6 variables, todas las columnas contienen datos completos, sin valores nulos. El DataFrame ‘med_test’ es significativamente más pequeño en comparación con el de entrenamiento, que tiene un tamaño mucho mayor.</p>
</section>
<section id="descriptiva-para-variables-categoricas">
<h2>Descriptiva para Variables Categóricas<a class="headerlink" href="#descriptiva-para-variables-categoricas" title="Link to this heading">#</a></h2>
<p>Se contaran el número de ocurrencias de cada valor en la columna ‘protein_name’ del DataFrame ‘medicinas’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteina</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">proteina</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>protein_name
BRD4    98415610
HSA     98415610
sEH     98415610
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">proteina_test</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">proteina_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>protein_name
BRD4    558859
sEH     558142
HSA     557895
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Los tres nombres de proteínas (BRD4, HSA, y sEH) tienen el mismo número de registros en cada Dataframe tanto el de entrenamiento ‘medicinas’ como el de prueba ‘med_test’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloke1</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bloke1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>buildingblock1_smiles
O=C(N[C@H]1CC[C@@H](C(=O)O)C1)OCC1c2ccccc2-c2ccccc21     1090407
O=C(O)[C@H]1CCN1C(=O)OCC1c2ccccc2-c2ccccc21              1090380
O=C(N[C@@H]1CC[C@H](C(=O)O)C1)OCC1c2ccccc2-c2ccccc21     1090368
O=C(N[C@@H](CC1CC1)C(=O)O)OCC1c2ccccc2-c2ccccc21         1090362
O=C(O)C1CN(C(=O)OCC2c3ccccc3-c3ccccc32)C1                1090329
                                                          ...   
O=C(O)CC1(CNC(=O)OCC2c3ccccc3-c3ccccc32)CCCCC1           1087461
O=C(NC[C@H]1CC[C@H](C(=O)O)CC1)OCC1c2ccccc2-c2ccccc21    1087428
O=C(NCC1CCC(C(=O)O)CC1)OCC1c2ccccc2-c2ccccc21            1087392
O=C(N[C@@H](Cc1ccco1)C(=O)O)OCC1c2ccccc2-c2ccccc21       1087374
O=C(NC1(C(=O)O)CCOCC1)OCC1c2ccccc2-c2ccccc21             1086975
Name: count, Length: 271, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloke1_test</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bloke1_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>buildingblock1_smiles
O=C(N[C@@H]1CCN(c2cc(C(=O)O)cc(Cl)n2)C1)OCC1c2ccccc2-c2ccccc21     14098
O=C(NC1CN(c2cc(C(=O)O)cc(Cl)n2)C1)OCC1c2ccccc2-c2ccccc21           14064
CC(C)(C)OC(=O)N1CCC(C(=O)O)(c2cccc(Br)c2)CC1                       14041
O=C(O)[C@@H]1C=C(c2ccnc(Br)c2)CN1C(=O)OCC1c2ccccc2-c2ccccc21       14039
O=C(O)[C@@H]1CN(C(=O)OCC2c3ccccc3-c3ccccc32)C[C@H]1c1ccnc(Cl)c1    14004
                                                                   ...  
O=C(N[C@H](Cc1c[nH]c2cc(Cl)ccc12)C(=O)O)OCC1c2ccccc2-c2ccccc21      1989
O=C(O)C[C@H](Cc1csc2ccccc12)NC(=O)OCC1c2ccccc2-c2ccccc21            1989
O=C(Nc1cc(O)cc(C(=O)O)c1)OCC1c2ccccc2-c2ccccc21                     1989
O=C(Nc1cc(Cl)c(C(=O)O)cn1)OCC1c2ccccc2-c2ccccc21                    1989
C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O                     1989
Name: count, Length: 341, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Explicacion de el primer bloque en ambos dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloke2</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bloke2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>buildingblock2_smiles
NCc1ccccn1                 706092
Cl.NCc1cnc2n1CCOC2         704376
NCc1c(F)cccc1N1CCCC1       703830
CC1(CCCCN)OCCO1            703320
Nc1cccc2cnccc12            702201
                            ...  
CN(Cc1ccco1)Cc1ccccc1CN    149202
COc1ccnc(N)c1              148164
Nc1cncc(F)c1               147363
Cl.NCc1ccc[nH]1            146751
Cl.Nc1ccc2cccnc2c1         146712
Name: count, Length: 693, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloke2_test</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bloke2_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>buildingblock2_smiles
Nc1nc(NCc2ccc(F)cc2)ccc1[N+](=O)[O-]    14637
Nc1cccc2ocnc12                          10161
CN1C(=O)Cc2cc(CN)ccc21.Cl               10077
Nc1nc(-c2cccnc2)cs1                      8031
Nc1ccc2[nH]c(=O)[nH]c2c1                 7302
                                        ...  
COC(=O)c1cc(Cl)sc1N                       204
Cc1ccc(N)cn1                              153
CC1(C)CCCC1(O)CN                          153
Cl.NC[C@@H]1C[C@H]1C1CCC1                 102
CN1CCN(c2cccc(N)c2)CC1                     51
Name: count, Length: 1140, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>explicacion del bloque dos en ambos dataframes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloke3</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bloke3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>buildingblock3_smiles
NCCc1nccc(C2CC2)n1         562191
COc1ccc2nnc(CN)n2n1        562164
NCc1cnc(N2CCOCC2)c(F)c1    562098
CCOC(=O)c1coc(N)n1         562023
Nc1nc2ccccc2[nH]1          562005
                            ...  
NCc1c(F)cccc1N1CCCC1         4062
Nc1nc(-c2ccc(F)cc2)cs1       2985
Cl.NCc1cnc2n1CCOC2           2376
CC1(CCCCN)OCCO1              1626
NCc1ccccn1                    798
Name: count, Length: 872, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bloke3_test</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bloke3_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>buildingblock3_smiles
Cl.Cl.NCCc1nnc2c(=O)[nH]ccn12           10323
Cc1nn(C)c2ncc(CN)cc12.Cl                 8481
NCC1CN2CCN1CC2                           8361
Nc1ccc2[nH]c(=O)[nH]c2c1                 6714
Nc1nc(NCc2ccc(F)cc2)ccc1[N+](=O)[O-]     6426
                                        ...  
NCc1ccccn1                                 15
Cl.NCC1Cc2ccccc2C1                          9
Cl.N#CC1(NC(=O)CN)CC1                       6
Nc1cccc2cnccc12                             3
NCc1c(F)cccc1N1CCCC1                        3
Name: count, Length: 1389, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>En el caso de la columna ‘buildingblock1_smiles’, se identificaron 271 valores únicos. De manera similar, la columna ‘buildingblock2_smiles’ cuenta con 693 valores únicos, y la columna ‘buildingblock3_smiles’ tiene 872 valores únicos, para confirmar la cantidad de valores únicos en cada columna de bloques de construcción, se utiliza la función .nunique()</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>271
693
872
</pre></div>
</div>
</div>
</div>
<p>Estos números reflejan la variabilidad y riqueza en la composición química de los bloques utilizados en el conjunto de datos, una mayor cantidad de valores únicos implica mayor diversidad en los tipos de bloques utilizados.</p>
</section>
<section id="descriptiva-para-la-variable-objetivo">
<h2>Descriptiva para la Variable Objetivo<a class="headerlink" href="#descriptiva-para-la-variable-objetivo" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">frecuencia_binds</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frecuencia_binds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    293656924
1      1589906
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Se visualiza la distribución de nuestra variable objetivo: ‘binds’</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">frecuencia_binds</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="c1"># Añadir títulos y etiquetas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frecuencia de Binds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Valores de Binds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/de8d3ba0e850e72e32459a30abc68096920d4a72c245e4baebfa64d6974f001e.png" src="_images/de8d3ba0e850e72e32459a30abc68096920d4a72c245e4baebfa64d6974f001e.png" />
</div>
</div>
<p>Donde podemos notar con claridad la gran diferencia en la proporción de los valores.
Un conjunto de datos tan desbalanceado puede sesgar los resultados de los modelos de clasificación, haciéndolos más propensos a predecir la clase mayoritaria (en este caso, binds = 0) y subestimando los casos donde binds = 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    0.994615
1    0.005385
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>La información muestra que la columna ‘binds’ está altamente desbalanceada, tenemos 293656924 observaciones (99,4%) de moleculas que no se unieron a la proteina y solo 1589906 (0,5%) si se unieron.</p>
<p><strong>Análisis de la variable proteina y su relación con binds</strong></p>
<p>En este análisis, hemos agrupado los datos por la variable proteina para verificar cuántos valores existen por cada clase de proteina, y además identificar la frecuencia y proporción de la variable binds (0 y 1) para cada clase.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cross_tab</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">],</span> <span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">])</span>
<span class="n">cross_tab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución Apilada de Binds por Proteina&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Proteina&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/99ced119c37a5d48ef7c1e4a410083004239f841dd0e0173008737a01e3ec307.png" src="_images/99ced119c37a5d48ef7c1e4a410083004239f841dd0e0173008737a01e3ec307.png" />
</div>
</div>
<p>os gráficos de barras apiladas muestran que, en cada tipo de proteína, la mayoría de las observaciones pertenecen a la clase 0 (indicando que las moléculas no se unieron), mientras que las observaciones de la clase 1 (indicando que sí se unieron) son mínimas. Esto sugiere un desbalance en los datos, con una predominancia de instancias donde no se produce la unión.</p>
</section>
<section id="datos-faltantes">
<h2>Datos Faltantes<a class="headerlink" href="#datos-faltantes" title="Link to this heading">#</a></h2>
<p>Comprobamos si hay datos faltantes tanto en el Dataframe de entrenamiento como enn el de test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_NA</span> <span class="o">=</span> <span class="n">medicinas</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">test_NA</span> <span class="o">=</span> <span class="n">med_test</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">train_NA</span><span class="p">,</span> <span class="n">test_NA</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Train NA&#39;</span><span class="p">,</span> <span class="s1">&#39;Test NA&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Train NA</th>
      <th>Test NA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>buildingblock1_smiles</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>buildingblock2_smiles</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>buildingblock3_smiles</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>molecule_smiles</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>protein_name</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>binds</th>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Los Dataframe no tienen valores faltantes, los NaN en la variable ‘binds’ es debido a la ausencia de esta información en el conjunto de datos de prueba (Test).</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modificacion-del-dataset">
<h1>Modificacion del dataset<a class="headerlink" href="#modificacion-del-dataset" title="Link to this heading">#</a></h1>
<p>Se ha decidido eliminar dos columnas del conjunto de datos: id y molecule_smiles. La columna id se ha excluido porque actúa únicamente como identificador único de las observaciones, sin aportar información relevante para el análisis. De manera similar, la columna molecule_smiles contiene nombres de moléculas que, aunque únicos, se repiten tres veces debido a la presencia de los tres tipos diferentes de proteínas en el conjunto de datos. Dado que estos valores se utilizan solo para la identificación y no influyen en el análisis predictivo, se considera innecesario mantenerlos. Además, la eliminación de estas columnas contribuye a reducir el tamaño del conjunto de datos, lo que optimiza el rendimiento del procesamiento y la velocidad de los modelos aligerando significativamente la base de datos y acelerando los procesos subsiguientes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas</span> <span class="o">=</span> <span class="n">medicinas</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_smiles&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_test</span> <span class="o">=</span> <span class="n">med_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;molecule_smiles&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<section id="division-de-la-base-de-datos">
<h2>Division de la base de datos<a class="headerlink" href="#division-de-la-base-de-datos" title="Link to this heading">#</a></h2>
<p>El DataFrame de entrenamiento cuenta con 295246830 filas y 5 columnas, de las cuales 5 son categóricas con 2 numéricas (la variable objetivo) y el id. Como sabemos el tamaño del dataset sigue siendo considerablemente grande, lo que relentiza los procesos analíticos. Por ello, se propone dividir el conjunto de datos en tres DataFrames separados, basados en las proteínas involucradas: uno para la proteína sEH, otro para HSA, y el tercero para BRD4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas_proteina1</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sEH&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">medicinas_proteina1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=C(C)C(=O)NCCN.Cl</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=CCNC(=O)CN.Cl</td>
      <td>sEH</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina1</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span><span class="o">==</span> <span class="s1">&#39;sEH&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">test_proteina1</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>molecule_smiles</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>295246832</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>5</th>
      <td>295246835</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ncnc3c2...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>8</th>
      <td>295246838</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC1(C)CCCC1(O)CN</td>
      <td>C#CCCC[C@H](Nc1nc(NCC2(O)CCCC2(C)C)nc(Nc2ccc(C...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>11</th>
      <td>295246841</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>COC(=O)c1cc(Cl)sc1N</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2sc(Cl)c...</td>
      <td>sEH</td>
    </tr>
    <tr>
      <th>14</th>
      <td>295246844</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CSC1CCC(CN)CC1</td>
      <td>C#CCCC[C@H](Nc1nc(NCC2CCC(SC)CC2)nc(Nc2ccc(C=C...</td>
      <td>sEH</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina1</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(558142, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas_proteina2</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;HSA&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">medicinas_proteina2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=C(C)C(=O)NCCN.Cl</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=CCNC(=O)CN.Cl</td>
      <td>HSA</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina2</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span><span class="o">==</span> <span class="s1">&#39;HSA&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">test_proteina2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>7</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC1(C)CCCC1(O)CN</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>10</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>COC(=O)c1cc(Cl)sc1N</td>
      <td>HSA</td>
    </tr>
    <tr>
      <th>13</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CSC1CCC(CN)CC1</td>
      <td>HSA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(557895, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">medicinas_proteina3</span> <span class="o">=</span> <span class="n">medicinas</span><span class="p">[</span><span class="n">medicinas</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BRD4&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">medicinas_proteina3</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>protein_name</th>
      <th>binds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.Br.NCC1CCCN1c1cccnn1</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>Br.NCc1cccc(Br)n1</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=C(C)C(=O)NCCN.Cl</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</td>
      <td>C#CCOc1ccc(CN)cc1.Cl</td>
      <td>C=CCNC(=O)CN.Cl</td>
      <td>BRD4</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina3</span> <span class="o">=</span> <span class="n">med_test</span><span class="p">[</span><span class="n">med_test</span><span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">]</span><span class="o">==</span> <span class="s1">&#39;BRD4&#39;</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">test_proteina3</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>protein_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC1(C)CCCC1(O)CN</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>COC(=O)c1cc(Cl)sc1N</td>
      <td>BRD4</td>
    </tr>
    <tr>
      <th>12</th>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CSC1CCC(CN)CC1</td>
      <td>BRD4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(558859, 4)
</pre></div>
</div>
</div>
</div>
<p>Nos quedo un tres dataset uno para cada proteina tanto el de entramiento como el de prueba, test_proteina1(test) cada uno con filas 558142 y 4 columnas, y el de medicinas_proteina1(train) con 98415610 filas y 5 columnas.</p>
</section>
<section id="extracion-de-datos">
<h2>Extración de datos<a class="headerlink" href="#extracion-de-datos" title="Link to this heading">#</a></h2>
<p>A continuacion se va a utilizar una porción de los datos en lugar de todo el dataset completo. En primer lugar, al reducir el número de observaciones, se disminuye la carga computacional, lo que acelera significativamente los tiempos de procesamiento y análisis. Además, el manejo de un dataset más pequeño permite optimizar recursos de hardware y evitando posibles problemas de memoria.
Teniendo en cuenta que se manera la misma proporción en la variable objetivo</p>
<section id="proteina-seh">
<h3>Proteina sEH<a class="headerlink" href="#proteina-seh" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final1</span> <span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">medicinas_proteina1</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">stratify</span> <span class="o">=</span> <span class="n">medicinas_proteina1</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final1</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;dataseh&#39;</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final1</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">KELLY</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">parcial1_ml</span><span class="se">\\</span><span class="s2">dataseh&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Aquí extraemos un millón de observaciones del dataset original para construir el nuevo DataFrame de entrenamiento. Esta estrategia permite reducir significativamente el tamaño del conjunto de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final1</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    0.992638
1    0.007362
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Se verifica que en el nuevo DataFrame de entrenamiento, con un millón de observaciones, se mantiene la misma proporción de moléculas que se unieron o no, tal como en el DataFrame original.</p>
</section>
<section id="proteina-hsa">
<h3>Proteina HSA<a class="headerlink" href="#proteina-hsa" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final2</span> <span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">medicinas_proteina2</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">stratify</span> <span class="o">=</span> <span class="n">medicinas_proteina2</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;datahsa&#39;</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">KELLY</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">parcial1_ml</span><span class="se">\\</span><span class="s2">datahsa&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final2</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    0.99585
1    0.00415
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>A pesar de haber extraído una porción del conjunto de datos original para el entrenamiento, hemos mantenido la proporción de la distribución de la variable objetivo. En la muestra, el 99.5% de las instancias pertenecen a la clase 0 (indicando que las moléculas no se unieron), mientras que el 0.4% pertenecen a la clase 1 (indicando que sí se unieron). Esta distribución es muy similar a la del conjunto de datos original, lo que asegura que la muestra sigue representando adecuadamente el desbalance de clases presente en el conjunto de datos completo.</p>
</section>
<section id="proteina-brd4">
<h3>Proteina BRD4<a class="headerlink" href="#proteina-brd4" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final3</span> <span class="p">,</span><span class="n">_</span><span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">medicinas_proteina3</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">stratify</span> <span class="o">=</span> <span class="n">medicinas_proteina3</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">11</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final3</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;databrd4&#39;</span><span class="p">,</span><span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final3</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">KELLY</span><span class="se">\\</span><span class="s2">Documents</span><span class="se">\\</span><span class="s2">parcial1_ml</span><span class="se">\\</span><span class="s2">databrd4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final3</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(100000, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final3</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>binds
0    0.99536
1    0.00464
Name: proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Comprobamos la porción del conjunto de datos original para el entrenamiento, hemos mantenido la distribución de la variable objetivo. En la muestra, el 99.5% de las instancias pertenecen a la clase 0 (indicando que las moléculas no se unieron), mientras que el 0.4% pertenecen a la clase 1 (indicando que sí se unieron).</p>
</section>
</section>
<section id="codificar-variables-categoricas">
<h2>Codificar variables categoricas<a class="headerlink" href="#codificar-variables-categoricas" title="Link to this heading">#</a></h2>
<section id="id1">
<h3>Proteina sEH<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>La lista categorical_columns define las columnas categóricas del dataset, que en este caso son: protein_name, buildingblock1_smiles, buildingblock2_smiles, y buildingblock3_smiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final1</span><span class="o">=</span><span class="n">med_final1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>El comando med_final1=med_final1.reset_index() se utiliza para restablecer los índices del DataFrame med_final1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> 
<span class="n">one_hot_encoded</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">med_final1</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>El código utiliza la clase OneHotEncoder de la biblioteca sklearn para convertir las columnas categóricas del DataFrame med_final1 en variables codificadas mediante “One-Hot Encoding”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encoded</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encoded</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">med_final1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">categorical_columns</span><span class="p">),</span><span class="n">one_hot_df</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_encoded</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1830 columns</p>
</div></div></div>
</div>
<p>Nos encontramos que el nuevo dataframe con las variables categoricas codificadas y solo se encuentran datos de 1 y 0.</p>
<p>Ahora se realiza el mismo proceso con el test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina1</span><span class="o">=</span><span class="n">test_proteina1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encodert</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> 
<span class="n">one_hot_encodedt</span> <span class="o">=</span> <span class="n">encodert</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_proteina1</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_dft</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encodedt</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encodert</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encodedt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_proteina1</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">categorical_columns</span><span class="p">),</span><span class="n">one_hot_dft</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Como resultado, obtenemos el conjunto de datos de prueba completamente codificado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_encodedt</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>id</th>
      <th>molecule_smiles</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_O=C(O)c1nccc(N2CCOCC2)n1</th>
      <th>buildingblock3_smiles_O=C(O)c1nccnc1N1CCCCC1</th>
      <th>buildingblock3_smiles_O=C(O)c1ncn(-c2ccccc2)n1</th>
      <th>buildingblock3_smiles_O=C(O)c1ncsc1C(F)(F)F</th>
      <th>buildingblock3_smiles_O=C(O)c1scc2c1CCCC2</th>
      <th>buildingblock3_smiles_O=C1CC(C(=O)O)c2cccnc2N1</th>
      <th>buildingblock3_smiles_O=C1CC2(C1)CC(C(=O)O)C2</th>
      <th>buildingblock3_smiles_O=C1CCC(C(=O)O)CC1</th>
      <th>buildingblock3_smiles_O=C1NC(=O)C2(CCC(C(=O)O)CC2)N1</th>
      <th>buildingblock3_smiles_O=C1NCC(Cn2cc(C(=O)O)nn2)O1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>295246832</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ccc(C=C...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>295246835</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2ncnc3c2...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8</td>
      <td>295246838</td>
      <td>C#CCCC[C@H](Nc1nc(NCC2(O)CCCC2(C)C)nc(Nc2ccc(C...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>11</td>
      <td>295246841</td>
      <td>C#CCCC[C@H](Nc1nc(Nc2ccc(C=C)cc2)nc(Nc2sc(Cl)c...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14</td>
      <td>295246844</td>
      <td>C#CCCC[C@H](Nc1nc(NCC2CCC(SC)CC2)nc(Nc2ccc(C=C...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 2870 columns</p>
</div></div></div>
</div>
</section>
<section id="id2">
<h3>Proteina HSA<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>Se realiza el mismo proceso que en el anterior dataframe de la proteina sED pero ahora con la Proteina HSA</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>La lista categorical_columns se utilizaran en los tres dataset: protein_name, buildingblock1_smiles, buildingblock2_smiles, y buildingblock3_smiles.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final2</span><span class="o">=</span><span class="n">med_final2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Al ejecutar esta función, se genera un nuevo índice secuencial para cada fila, mientras que el índice original, si existe, se convierte en una columna del DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoder2</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> 
<span class="n">one_hot_encoded2</span> <span class="o">=</span> <span class="n">encoder2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">med_final2</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encoded2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder2</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encoded2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">med_final2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">categorical_columns</span><span class="p">),</span><span class="n">one_hot_df2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_encoded2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1834 columns</p>
</div></div></div>
</div>
<p>El nuevo dataframe con las variables categoricas codificadas y solo se encuentran datos de 1 y 0.</p>
<p>Se realiza lo mismo con el test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina2</span><span class="o">=</span><span class="n">test_proteina2</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encodert2</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> 
<span class="n">one_hot_encodedt2</span> <span class="o">=</span> <span class="n">encodert2</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_proteina2</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_dft2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encodedt2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encodert2</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encodedt2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_proteina2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">categorical_columns</span><span class="p">),</span><span class="n">one_hot_dft2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_encodedt2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>buildingblock1_smiles</th>
      <th>buildingblock2_smiles</th>
      <th>buildingblock3_smiles</th>
      <th>protein_name</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_O=C(O)c1nccc(N2CCOCC2)n1</th>
      <th>buildingblock3_smiles_O=C(O)c1nccnc1N1CCCCC1</th>
      <th>buildingblock3_smiles_O=C(O)c1ncn(-c2ccccc2)n1</th>
      <th>buildingblock3_smiles_O=C(O)c1ncsc1C(F)(F)F</th>
      <th>buildingblock3_smiles_O=C(O)c1scc2c1CCCC2</th>
      <th>buildingblock3_smiles_O=C1CC(C(=O)O)c2cccnc2N1</th>
      <th>buildingblock3_smiles_O=C1CC2(C1)CC(C(=O)O)C2</th>
      <th>buildingblock3_smiles_O=C1CCC(C(=O)O)CC1</th>
      <th>buildingblock3_smiles_O=C1NC(=O)C2(CCC(C(=O)O)CC2)N1</th>
      <th>buildingblock3_smiles_O=C1NCC(Cn2cc(C(=O)O)nn2)O1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>HSA</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC(O)Cn1cnc2c(N)ncnc21</td>
      <td>HSA</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CC1(C)CCCC1(O)CN</td>
      <td>HSA</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>COC(=O)c1cc(Cl)sc1N</td>
      <td>HSA</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>C#CCCC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</td>
      <td>C=Cc1ccc(N)cc1</td>
      <td>CSC1CCC(CN)CC1</td>
      <td>HSA</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 2872 columns</p>
</div></div></div>
</div>
</section>
<section id="id3">
<h3>Proteina BRD4<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>Por ultimo codificamos la Proteina BRD4 con el mismo proceso que en los anteriores Dataframes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">categorical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;protein_name&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock1_smiles&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock2_smiles&#39;</span><span class="p">,</span><span class="s1">&#39;buildingblock3_smiles&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">med_final3</span><span class="o">=</span><span class="n">med_final3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoder3</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> 
<span class="n">one_hot_encoded3</span> <span class="o">=</span> <span class="n">encoder3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">med_final3</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encoded3</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder3</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encoded3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">med_final3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">categorical_columns</span><span class="p">),</span><span class="n">one_hot_df3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_encoded3</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>binds</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
      <th>buildingblock3_smiles_Nc1ncnc(Cl)c1Cl</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]cnc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2[nH]ncc12</th>
      <th>buildingblock3_smiles_Nc1ncnc2c1ncn2C1CCCCO1</th>
      <th>buildingblock3_smiles_Nc1ncncc1Br</th>
      <th>buildingblock3_smiles_Nc1nnc(S)s1</th>
      <th>buildingblock3_smiles_Nc1nncs1</th>
      <th>buildingblock3_smiles_Nc1nnn[nH]1</th>
      <th>buildingblock3_smiles_Nc1noc2ccc(F)cc12</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 1834 columns</p>
</div></div></div>
</div>
<p>Codificación del test</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_proteina3</span><span class="o">=</span><span class="n">test_proteina3</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encodert3</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">sparse_output</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span> 
<span class="n">one_hot_encodedt3</span> <span class="o">=</span> <span class="n">encodert3</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_proteina3</span><span class="p">[</span><span class="n">categorical_columns</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_dft3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">one_hot_encodedt3</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encodert3</span><span class="o">.</span><span class="n">get_feature_names_out</span><span class="p">(</span><span class="n">categorical_columns</span><span class="p">))</span>
<span class="n">df_encodedt3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">test_proteina3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span> <span class="n">categorical_columns</span><span class="p">),</span><span class="n">one_hot_dft3</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">df_encodedt3</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>buildingblock1_smiles_C#CC[C@@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@H](CC(=O)O)NC(=O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_C#CC[C@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(CC=C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CCC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C=CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>...</th>
      <th>buildingblock3_smiles_O=C(O)c1nccc(N2CCOCC2)n1</th>
      <th>buildingblock3_smiles_O=C(O)c1nccnc1N1CCCCC1</th>
      <th>buildingblock3_smiles_O=C(O)c1ncn(-c2ccccc2)n1</th>
      <th>buildingblock3_smiles_O=C(O)c1ncsc1C(F)(F)F</th>
      <th>buildingblock3_smiles_O=C(O)c1scc2c1CCCC2</th>
      <th>buildingblock3_smiles_O=C1CC(C(=O)O)c2cccnc2N1</th>
      <th>buildingblock3_smiles_O=C1CC2(C1)CC(C(=O)O)C2</th>
      <th>buildingblock3_smiles_O=C1CCC(C(=O)O)CC1</th>
      <th>buildingblock3_smiles_O=C1NC(=O)C2(CCC(C(=O)O)CC2)N1</th>
      <th>buildingblock3_smiles_O=C1NCC(Cn2cc(C(=O)O)nn2)O1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>12</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 2868 columns</p>
</div></div></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="prueba-de-chi-cuadrado-para-multicolinealidad-entre-variables-categoricas">
<h1>Prueba de Chi-Cuadrado para Multicolinealidad (entre Variables Categóricas)<a class="headerlink" href="#prueba-de-chi-cuadrado-para-multicolinealidad-entre-variables-categoricas" title="Link to this heading">#</a></h1>
<p>Se va a identificar si hay dependencia significativa entre las variables categóricas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">df_encoded</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">]</span> 

<span class="n">k_best</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  
<span class="n">X_new</span> <span class="o">=</span> <span class="n">k_best</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_encoded</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">selected_features</span> <span class="o">=</span> <span class="n">k_best</span><span class="o">.</span><span class="n">get_support</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">one_hot_df_reduced</span> <span class="o">=</span> <span class="n">one_hot_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">selected_features</span><span class="p">]</span>
<span class="n">selected_names</span> <span class="o">=</span> <span class="n">df_encoded</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selected_features</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>El código aplica la técnica de selección de características SelectKBest con la estadística chi-cuadrado (chi2) para identificar las 100 variables más relevantes del conjunto de datos codificado. Primero se define la variable objetivo y (la columna binds), y luego se ajusta SelectKBest para evaluar la dependencia entre las características categóricas codificadas y la variable objetivo. Posteriormente, se seleccionan los índices de las mejores características y se extraen del DataFrame original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">one_hot_df_reduced</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>buildingblock1_smiles_C#CC[C@@H](NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_C#CC[C@@](C)(NC(=O)OCC1c2ccccc2-c2ccccc21)C(=O)O</th>
      <th>buildingblock1_smiles_O=C(NC1(C(=O)O)CCC1)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(NCc1cccc(C(=O)O)c1)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(N[C@@H](C(=O)O)C1CCCC1)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(N[C@@H](Cc1cccs1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(N[C@H](Cc1ccc([N+](=O)[O-])cc1)C(=O)O)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(Nc1ccc(C(=O)O)cc1Cl)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(Nc1ccc(C(=O)O)cn1)OCC1c2ccccc2-c2ccccc21</th>
      <th>buildingblock1_smiles_O=C(Nc1ccc(Cl)c(C(=O)O)c1)OCC1c2ccccc2-c2ccccc21</th>
      <th>...</th>
      <th>buildingblock3_smiles_Nc1cc(-c2cccc(Br)c2)no1</th>
      <th>buildingblock3_smiles_Nc1cc(C2CC2)[nH]n1</th>
      <th>buildingblock3_smiles_Nc1cc(Cl)cnc1Cl</th>
      <th>buildingblock3_smiles_Nc1cc(F)cc(F)c1[N+](=O)[O-]</th>
      <th>buildingblock3_smiles_Nc1ccc2c(c1)OCCCO2</th>
      <th>buildingblock3_smiles_Nc1cccnc1Cl</th>
      <th>buildingblock3_smiles_Nc1cncnc1</th>
      <th>buildingblock3_smiles_Nc1nc(-c2ccc(Cl)c(Cl)c2)cs1</th>
      <th>buildingblock3_smiles_Nc1nc2c(Br)cccc2s1</th>
      <th>buildingblock3_smiles_Nc1ncnc(=O)[nH]1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 100 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="modelos-de-clasificacion">
<h1>Modelos de clasificación<a class="headerlink" href="#modelos-de-clasificacion" title="Link to this heading">#</a></h1>
<section id="id4">
<h2>Proteina sEH<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_encoded</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;binds&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">df_encoded</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>


<span class="n">knn_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>  
    <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())</span>  
<span class="p">])</span>


<span class="n">logreg_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> 
    <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">))</span>
<span class="p">])</span>


<span class="n">knn_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> 
<span class="p">}</span>

<span class="n">logreg_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  
<span class="p">}</span>


<span class="n">knn_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">knn_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">knn_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">logreg_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">logreg_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">logreg_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>


<span class="n">knn_grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">logreg_grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor número de vecinos KNN:&quot;</span><span class="p">,</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor valor de C para Regresión Logística:&quot;</span><span class="p">,</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;logreg__C&#39;</span><span class="p">])</span>



<span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred_logreg</span> <span class="o">=</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_prob_knn</span> <span class="o">=</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_prob_logreg</span> <span class="o">=</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor número de vecinos KNN: 11
Mejor valor de C para Regresión Logística: 0.1
</pre></div>
</div>
</div>
</div>
<p>E mejor desempeño para el modelo K-NN se logra con 11 vecinos, lo que optimiza la capacidad del modelo para clasificar las instancias. Para la Regresión Logística, el mejor rendimiento se obtiene con un valor de C = 0.1, lo que controla la regularización del modelo y mejora su capacidad para generalizar. Estos ajustes son cruciales para maximizar la precisión y el rendimiento general de los modelos en la clasificación de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN - Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regresión Logística - Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN - Reporte de clasificación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="n">auc_knn</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_knn</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regresión Logística - Reporte de clasificación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">))</span>
<span class="n">auc_logreg</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_logreg</span><span class="p">)</span>



<span class="k">if</span> <span class="n">auc_knn</span> <span class="o">&gt;</span> <span class="n">auc_logreg</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El mejor modelo es KNN con AUC:&quot;</span><span class="p">,</span> <span class="n">auc_knn</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El mejor modelo es Regresión Logística con AUC:&quot;</span><span class="p">,</span> <span class="n">auc_logreg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN - Matriz de confusión:
 [[29783     0]
 [  217     0]]
Regresión Logística - Matriz de confusión:
 [[29708    75]
 [  119    98]]
KNN - Reporte de clasificación:
               precision    recall  f1-score   support

           0       0.99      1.00      1.00     29783
           1       0.00      0.00      0.00       217

    accuracy                           0.99     30000
   macro avg       0.50      0.50      0.50     30000
weighted avg       0.99      0.99      0.99     30000

Regresión Logística - Reporte de clasificación:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00     29783
           1       0.57      0.45      0.50       217

    accuracy                           0.99     30000
   macro avg       0.78      0.72      0.75     30000
weighted avg       0.99      0.99      0.99     30000

El mejor modelo es Regresión Logística con AUC: 0.9605086624278131
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre></div>
</div>
</div>
</div>
<p>El análisis muestra que la Regresión Logística supera al modelo KNN en términos de desempeño. La matriz de confusión y el reporte de clasificación para KNN revelan que el modelo no identifica correctamente las instancias de la clase positiva (1), resultando en una precisión nula para esta clase y una AUC baja de 0.646. En contraste, la Regresión Logística clasifica correctamente tanto la clase negativa (0) como la positiva (1), con una precisión y recall más equilibrados, y un notable AUC de 0.961. Esto indica que la Regresión Logística tiene una mejor capacidad para distinguir entre las clases y es, por lo tanto, el modelo más efectivo en este caso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_knn</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_knn</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;KNN&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">,</span>
    <span class="n">plot_chance_level</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">display_knn</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curva ROC - KNN&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f3c7aad16dfc731992a0139ce7144567672dce6c5266fb4fd0cadd4f1e551491.png" src="_images/f3c7aad16dfc731992a0139ce7144567672dce6c5266fb4fd0cadd4f1e551491.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_logreg</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_logreg</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Regresión Logística&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span>
    <span class="n">plot_chance_level</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">display_logreg</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curva ROC - Regresión Logística&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6056b6512483cdaf1aa64ed790c469c62fb77b3dac2f97d4eae8cfe615688712.png" src="_images/6056b6512483cdaf1aa64ed790c469c62fb77b3dac2f97d4eae8cfe615688712.png" />
</div>
</div>
<p>las curvas ROC confirmarán que la Regresión Logística no solo es más efectiva en términos de AUC, sino también en su capacidad general para clasificar correctamente las instancias en comparación con KNN. La Regresión Logística debería mostrar una curva más cercana a la esquina superior izquierda del gráfico ROC, indicando mejor desempeño en la clasificación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Regresión Logística&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">auc_knn</span><span class="p">,</span> <span class="n">auc_logreg</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabla de error:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tabla de error:
                Modelo  Precisión    Recall  F1-Score       AUC
0                 K-NN   0.000000  0.000000  0.000000  0.646390
1  Regresión Logística   0.566474  0.451613  0.502564  0.960509
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre></div>
</div>
</div>
</div>
<p>-K-NN presenta una precisión, recall y F1-Score de 0.000000 para la clase positiva, reflejando un desempeño deficiente en la identificación de esta clase. Su AUC de 0.646390 sugiere una capacidad limitada para discriminar entre las clases.
-Regresión Logística muestra una precisión de 0.566474, un recall de 0.451613 y un F1-Score de 0.502564, indicando una mejor capacidad para clasificar las instancias de la clase positiva. Además, su AUC de 0.960509 destaca una excelente habilidad para distinguir entre las clases, confirmando su superioridad sobre el modelo K-NN en términos de desempeño general.</p>
</section>
<section id="id5">
<h2>Proteina HSA<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_encoded2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;binds&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">df_encoded2</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="n">knn_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>  
    <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())</span>  
<span class="p">])</span>
<span class="n">logreg_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> 
    <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">knn_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> 
<span class="p">}</span>
<span class="n">logreg_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  
<span class="p">}</span>
<span class="n">knn_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">knn_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">knn_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">logreg_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">logreg_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">logreg_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>

<span class="n">knn_grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">logreg_grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor número de vecinos KNN:&quot;</span><span class="p">,</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor valor de C para Regresión Logística:&quot;</span><span class="p">,</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;logreg__C&#39;</span><span class="p">])</span>
<span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred_logreg</span> <span class="o">=</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_prob_knn</span> <span class="o">=</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_prob_logreg</span> <span class="o">=</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor número de vecinos KNN: 11
Mejor valor de C para Regresión Logística: 0.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN - Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regresión Logística - Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN - Reporte de clasificación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="n">auc_knn</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_knn</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regresión Logística - Reporte de clasificación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">))</span>
<span class="n">auc_logreg</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_logreg</span><span class="p">)</span>



<span class="k">if</span> <span class="n">auc_knn</span> <span class="o">&gt;</span> <span class="n">auc_logreg</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El mejor modelo es KNN con AUC:&quot;</span><span class="p">,</span> <span class="n">auc_knn</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El mejor modelo es Regresión Logística con AUC:&quot;</span><span class="p">,</span> <span class="n">auc_logreg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN - Matriz de confusión:
 [[29879     0]
 [  121     0]]
Regresión Logística - Matriz de confusión:
 [[29861    18]
 [  113     8]]
KNN - Reporte de clasificación:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00     29879
           1       0.00      0.00      0.00       121

    accuracy                           1.00     30000
   macro avg       0.50      0.50      0.50     30000
weighted avg       0.99      1.00      0.99     30000

Regresión Logística - Reporte de clasificación:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00     29879
           1       0.31      0.07      0.11       121

    accuracy                           1.00     30000
   macro avg       0.65      0.53      0.55     30000
weighted avg       0.99      1.00      0.99     30000

El mejor modelo es Regresión Logística con AUC: 0.9041848956078774
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre></div>
</div>
</div>
</div>
<p>Para KNN, la matriz de confusión muestra que predice todas las instancias de la clase mayoritaria (0) correctamente, pero no logra predecir ningún caso de la clase minoritaria (1). Esto se refleja en el reporte de clasificación, donde la precisión, recall y f1-score para la clase 1 son todos 0, lo que sugiere que KNN no es efectivo en distinguir las observaciones de la clase minoritaria. El modelo tiene un alto nivel de precisión general, pero esto se debe a la predominancia de la clase 0.</p>
<p>Por otro lado, la Regresión Logística logra identificar algunos casos de la clase 1, aunque de manera limitada, con una precisión de 31% para la clase 1 y un recall del 7%. A pesar de que es mejor que KNN en reconocer la clase minoritaria, el desempeño sigue siendo bajo. La precisión general sigue siendo alta debido a la predominancia de la clase 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_knn</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_knn</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;KNN&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">,</span>
    <span class="n">plot_chance_level</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">display_knn</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curva ROC - KNN&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e9d7e7d66ae15d36356d1b533eaf8323a7b220d21cf94124825f5662d1969a54.png" src="_images/e9d7e7d66ae15d36356d1b533eaf8323a7b220d21cf94124825f5662d1969a54.png" />
</div>
</div>
<p>Dado que KNN no logró predecir correctamente ninguna instancia de la clase minoritaria (1) en la matriz de confusión, a curva ROC de KNN esté cerca de la línea diagonal (una línea con un AUC cercano a 0.5). Esto indica que KNN no tiene una capacidad significativa para discriminar entre las clases, especialmente debido al desbalance extremo de la variable objetivo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_logreg</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_logreg</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Regresión Logística&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span>
    <span class="n">plot_chance_level</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">display_logreg</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curva ROC - Regresión Logística&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dff61cc53fa2f7b5c8dfc6245ab13e892227d8bcce5bda6537a5a588a21c7e14.png" src="_images/dff61cc53fa2f7b5c8dfc6245ab13e892227d8bcce5bda6537a5a588a21c7e14.png" />
</div>
</div>
<p>Aunque la Regresión Logística tiene un mejor rendimiento que KNN al identificar algunos casos de la clase minoritaria (1).En comparación con KNN, su curva ROC está mejor situada, más arriba en la gráfica, lo que indica una mejor capacidad de discriminación entre las clases. El AUC de la Regresión Logística es mayor que el de KNN, ya que este modelo muestra más capacidad para diferenciar entre clases, como lo reflejan sus valores de precisión y recall.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Regresión Logística&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">auc_knn</span><span class="p">,</span> <span class="n">auc_logreg</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabla de error:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tabla de error:
                Modelo  Precisión    Recall  F1-Score       AUC
0                 K-NN   0.000000  0.000000  0.000000  0.655523
1  Regresión Logística   0.307692  0.066116  0.108844  0.904185
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre></div>
</div>
</div>
</div>
<p>El modelo de K-NN tiene una precisión, recall y F1-Score de 0, lo que indica que no está capturando correctamente las observaciones de la clase minoritaria (clase 1). Sin embargo, su AUC es de 0.655523, lo que sugiere que tiene alguna capacidad para distinguir entre clases, aunque no es eficaz.</p>
<p>La regresion logistica tiene mejor rendimiento en términos de precisión (30.77%), recall (6.61%) y F1-Score (10.88%), el modelo aún tiene dificultades para identificar correctamente la clase 1. No obstante, el AUC de 0.904185 indica que la Regresión Logística tiene un desempeño significativamente mejor que K-NN en la diferenciación entre las clases.</p>
</section>
<section id="id6">
<h2>Proteina BRD4<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df_encoded3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;binds&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">df_encoded3</span><span class="p">[</span><span class="s1">&#39;binds&#39;</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.30</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">101</span><span class="p">)</span>

<span class="n">knn_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>  
    <span class="p">(</span><span class="s1">&#39;knn&#39;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">())</span>  
<span class="p">])</span>
<span class="n">logreg_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;scaler&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span> 
    <span class="p">(</span><span class="s1">&#39;logreg&#39;</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">))</span>
<span class="p">])</span>
<span class="n">knn_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> 
<span class="p">}</span>
<span class="n">logreg_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;logreg__C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>  
<span class="p">}</span>
<span class="n">knn_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">knn_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">knn_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>
<span class="n">logreg_grid</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">logreg_pipeline</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">logreg_params</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;roc_auc&#39;</span><span class="p">)</span>

<span class="n">knn_grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">logreg_grid</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor número de vecinos KNN:&quot;</span><span class="p">,</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;knn__n_neighbors&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejor valor de C para Regresión Logística:&quot;</span><span class="p">,</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_params_</span><span class="p">[</span><span class="s1">&#39;logreg__C&#39;</span><span class="p">])</span>
<span class="n">y_pred_knn</span> <span class="o">=</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred_logreg</span> <span class="o">=</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_prob_knn</span> <span class="o">=</span> <span class="n">knn_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">y_prob_logreg</span> <span class="o">=</span> <span class="n">logreg_grid</span><span class="o">.</span><span class="n">best_estimator_</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejor número de vecinos KNN: 11
Mejor valor de C para Regresión Logística: 0.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN - Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regresión Logística - Matriz de confusión:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;KNN - Reporte de clasificación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">))</span>
<span class="n">auc_knn</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_knn</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Regresión Logística - Reporte de clasificación:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">))</span>
<span class="n">auc_logreg</span> <span class="o">=</span> <span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_logreg</span><span class="p">)</span>



<span class="k">if</span> <span class="n">auc_knn</span> <span class="o">&gt;</span> <span class="n">auc_logreg</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El mejor modelo es KNN con AUC:&quot;</span><span class="p">,</span> <span class="n">auc_knn</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;El mejor modelo es Regresión Logística con AUC:&quot;</span><span class="p">,</span> <span class="n">auc_logreg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>KNN - Matriz de confusión:
 [[29840     0]
 [  160     0]]
Regresión Logística - Matriz de confusión:
 [[29817    23]
 [  137    23]]
KNN - Reporte de clasificación:
               precision    recall  f1-score   support

           0       0.99      1.00      1.00     29840
           1       0.00      0.00      0.00       160

    accuracy                           0.99     30000
   macro avg       0.50      0.50      0.50     30000
weighted avg       0.99      0.99      0.99     30000

Regresión Logística - Reporte de clasificación:
               precision    recall  f1-score   support

           0       1.00      1.00      1.00     29840
           1       0.50      0.14      0.22       160

    accuracy                           0.99     30000
   macro avg       0.75      0.57      0.61     30000
weighted avg       0.99      0.99      0.99     30000

El mejor modelo es Regresión Logística con AUC: 0.9224807305630026
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre></div>
</div>
</div>
</div>
<p>En este análisis, la Regresión Logística supera claramente al modelo K-NN en la clasificación de las observaciones. Mientras que K-NN no logra identificar ningún caso de la clase minoritaria (binds = 1), Regresión Logística, aunque con un recall bajo (0.14), logra predecir correctamente algunos casos de dicha clase. Esto sugiere que Regresión Logística es más eficaz para manejar el desequilibrio de clases en los datos, siendo un modelo más adecuado para este problema, ya que puede identificar ciertos casos de la clase menos representada, algo que K-NN no consigue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_logreg</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_logreg</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Regresión Logística&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkblue&quot;</span><span class="p">,</span>
    <span class="n">plot_chance_level</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">display_logreg</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curva ROC - Regresión Logística&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/95dcf40cb69fa4d0d53939d9de33f9a1a6dcb6e9f398460e6447e998f8b9696d.png" src="_images/95dcf40cb69fa4d0d53939d9de33f9a1a6dcb6e9f398460e6447e998f8b9696d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display_knn</span> <span class="o">=</span> <span class="n">RocCurveDisplay</span><span class="o">.</span><span class="n">from_predictions</span><span class="p">(</span>
    <span class="n">y_test</span><span class="p">,</span> <span class="n">y_prob_knn</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;KNN&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">,</span>
    <span class="n">plot_chance_level</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">display_knn</span><span class="o">.</span><span class="n">ax_</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;False Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;True Positive Rate&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Curva ROC - KNN&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5457772b0b28e4f12b1122da4176b3504ca589859526e3309acbfd1267aa038e.png" src="_images/5457772b0b28e4f12b1122da4176b3504ca589859526e3309acbfd1267aa038e.png" />
</div>
</div>
<p>Al analizar las curvas ROC para ambos modelos, K-NN y Regresión Logística, es evidente que la Regresión Logística tiene un rendimiento superior en comparación con K-NN. La curva ROC de la Regresión Logística se sitúa más cerca de la esquina superior izquierda del gráfico, lo que indica una mejor capacidad para distinguir entre las clases positivas y negativas. Esto es consistente con los resultados de las matrices de confusión y los reportes de clasificación, donde la Regresión Logística, a pesar de sus limitaciones, muestra un AUC significativamente más alto, indicando que es más efectiva en la identificación de la clase minoritaria (binds = 1) en comparación con K-NN.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Modelo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;K-NN&#39;</span><span class="p">,</span> <span class="s1">&#39;Regresión Logística&#39;</span><span class="p">],</span>
    <span class="s1">&#39;Precisión&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;Recall&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;F1-Score&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_knn</span><span class="p">),</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred_logreg</span><span class="p">)],</span>
    <span class="s1">&#39;AUC&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">auc_knn</span><span class="p">,</span> <span class="n">auc_logreg</span><span class="p">]</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Tabla de error:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tabla de error:
                Modelo  Precisión   Recall  F1-Score       AUC
0                 K-NN        0.0  0.00000  0.000000  0.670068
1  Regresión Logística        0.5  0.14375  0.223301  0.922481
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\KELLY\miniconda3\envs\ml_venv\lib\site-packages\sklearn\metrics\_classification.py:1469: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre></div>
</div>
</div>
</div>
<p>La Regresión Logística presenta un rendimiento notablemente mejor en términos de recall y F1-Score para la clase minoritaria (1). Esto es evidente por su mayor recall (0.14375 frente a 0.00000) y un F1-Score más alto (0.223301 frente a 0.000000). Además, la Regresión Logística tiene un AUC de 0.922481, que es considerablemente superior al AUC de 0.670068 de K-NN.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Ejercicio_1parte_2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Ejercicio 1 parte 2</p>
      </div>
    </a>
    <a class="right-next"
       href="Ejercicio_2parte_2%28EDA%29.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Ejercicio 2</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Análisis del Problema de Aplicación</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#librerias">Librerias</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#descripcion-del-dataset-original">Descripción del Dataset original</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-entrenamiento">Datos de entrenamiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-de-prueba">Datos de prueba</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptiva-para-variables-categoricas">Descriptiva para Variables Categóricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptiva-para-la-variable-objetivo">Descriptiva para la Variable Objetivo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#datos-faltantes">Datos Faltantes</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modificacion-del-dataset">Modificacion del dataset</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#division-de-la-base-de-datos">Division de la base de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extracion-de-datos">Extración de datos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proteina-seh">Proteina sEH</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proteina-hsa">Proteina HSA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#proteina-brd4">Proteina BRD4</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#codificar-variables-categoricas">Codificar variables categoricas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Proteina sEH</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Proteina HSA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Proteina BRD4</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-chi-cuadrado-para-multicolinealidad-entre-variables-categoricas">Prueba de Chi-Cuadrado para Multicolinealidad (entre Variables Categóricas)</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#modelos-de-clasificacion">Modelos de clasificación</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">Proteina sEH</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">Proteina HSA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">Proteina BRD4</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Kelly Beltran y Henry Saenz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>